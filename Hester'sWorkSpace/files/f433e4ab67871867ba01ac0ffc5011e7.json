{"author": "rg3", "code": "from __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    parse_duration,\n    parse_iso8601,\n)\n\n\nclass MLBIE(InfoExtractor):\n    _VALID_URL = r\n    _TESTS = [\n        {\n            'url': 'http://m.mlb.com/sea/video/topic/51231442/v34698933/nymsea-ackley-robs-a-home-run-with-an-amazing-catch/?c_id=sea',\n            'md5': 'ff56a598c2cf411a9a38a69709e97079',\n            'info_dict': {\n                'id': '34698933',\n                'ext': 'mp4',\n                'title': \"Ackley's spectacular catch\",\n                'description': 'md5:7f5a981eb4f3cbc8daf2aeffa2215bf0',\n                'duration': 66,\n                'timestamp': 1405980600,\n                'upload_date': '20140721',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/video/topic/81536970/v34496663/mianym-stanton-practices-for-the-home-run-derby',\n            'md5': 'd9c022c10d21f849f49c05ae12a8a7e9',\n            'info_dict': {\n                'id': '34496663',\n                'ext': 'mp4',\n                'title': 'Stanton prepares for Derby',\n                'description': 'md5:d00ce1e5fd9c9069e9c13ab4faedfa57',\n                'duration': 46,\n                'timestamp': 1405105800,\n                'upload_date': '20140711',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/video/topic/vtp_hrd_sponsor/v34578115/hrd-cespedes-wins-2014-gillette-home-run-derby',\n            'md5': '0e6e73d509321e142409b695eadd541f',\n            'info_dict': {\n                'id': '34578115',\n                'ext': 'mp4',\n                'title': 'Cespedes repeats as Derby champ',\n                'description': 'md5:08df253ce265d4cf6fb09f581fafad07',\n                'duration': 488,\n                'timestamp': 1405399936,\n                'upload_date': '20140715',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/video/v34577915/bautista-on-derby-captaining-duties-his-performance',\n            'md5': 'b8fd237347b844365d74ea61d4245967',\n            'info_dict': {\n                'id': '34577915',\n                'ext': 'mp4',\n                'title': 'Bautista on Home Run Derby',\n                'description': 'md5:b80b34031143d0986dddc64a8839f0fb',\n                'duration': 52,\n                'timestamp': 1405390722,\n                'upload_date': '20140715',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/news/article/118550098/blue-jays-kevin-pillar-goes-spidey-up-the-wall-to-rob-tim-beckham-of-a-homer',\n            'md5': 'aafaf5b0186fee8f32f20508092f8111',\n            'info_dict': {\n                'id': '75609783',\n                'ext': 'mp4',\n                'title': 'Must C: Pillar climbs for catch',\n                'description': '4/15/15: Blue Jays outfielder Kevin Pillar continues his defensive dominance by climbing the wall in left to rob Tim Beckham of a home run',\n                'timestamp': 1429124820,\n                'upload_date': '20150415',\n            }\n        },\n        {\n            'url': 'https://www.mlb.com/video/hargrove-homers-off-caldwell/c-1352023483?tid=67793694',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://m.mlb.com/shared/video/embed/embed.html?content_id=35692085&topic_id=6479266&width=400&height=224&property=mlb',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://mlb.mlb.com/shared/video/embed/embed.html?content_id=36599553',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://mlb.mlb.com/es/video/play.jsp?content_id=36599553',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://m.cardinals.mlb.com/stl/video/v51175783/atlstl-piscotty-makes-great-sliding-catch-on-line/?partnerId=as_mlb_20150321_42500876&adbid=579409712979910656&adbpl=tw&adbpr=52847728',\n            'only_matching': True,\n        },\n        {\n            \n            'url': 'http://mlb.mlb.com/shared/video/embed/m-internal-embed.html?content_id=75609783&property=mlb&autoplay=true&hashmode=false&siteSection=mlb/multimedia/article_118550098/article_embed&club=mlb',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://washington.nationals.mlb.com/mlb/gameday/index.jsp?c_id=was&gid=2015_05_09_atlmlb_wasmlb_1&lang=en&content_id=108309983&mode=video\n            'only_matching': True,\n        }\n    ]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        video_id = mobj.group('id')\n\n        if not video_id:\n            video_path = mobj.group('path')\n            webpage = self._download_webpage(url, video_path)\n            video_id = self._search_regex(\n                [r'data-video-?id=\"(\\d+)\"', r'content_id=(\\d+)'], webpage, 'video id')\n\n        detail = self._download_xml(\n            'http://m.mlb.com/gen/multimedia/detail/%s/%s/%s/%s.xml'\n            % (video_id[-3], video_id[-2], video_id[-1], video_id), video_id)\n\n        title = detail.find('./headline').text\n        description = detail.find('./big-blurb').text\n        duration = parse_duration(detail.find('./duration').text)\n        timestamp = parse_iso8601(detail.attrib['date'][:-5])\n\n        thumbnails = [{\n            'url': thumbnail.text,\n        } for thumbnail in detail.findall('./thumbnailScenarios/thumbnailScenario')]\n\n        formats = []\n        for media_url in detail.findall('./url'):\n            playback_scenario = media_url.attrib['playback_scenario']\n            fmt = {\n                'url': media_url.text,\n                'format_id': playback_scenario,\n            }\n            m = re.search(r'(?P<vbr>\\d+)K_(?P<width>\\d+)X(?P<height>\\d+)', playback_scenario)\n            if m:\n                fmt.update({\n                    'vbr': int(m.group('vbr')) * 1000,\n                    'width': int(m.group('width')),\n                    'height': int(m.group('height')),\n                })\n            formats.append(fmt)\n\n        self._sort_formats(formats)\n\n        return {\n            'id': video_id,\n            'title': title,\n            'description': description,\n            'duration': duration,\n            'timestamp': timestamp,\n            'formats': formats,\n            'thumbnails': thumbnails,\n        }\n", "comments": "(?x)\n                    https?://\n                        (?:[\\da-z_-]+\\.)*mlb\\.com/\n                        (?:\n                            (?:\n                                (?:.*?/)?video/(?:topic/[\\da-z_-]+/)?(?:v|.*?/c-)|\n                                (?:\n                                    shared/video/embed/(?:embed|m-internal-embed)\\.html|\n                                    (?:[^/]+/)+(?:play|index)\\.jsp|\n                                )\\?.*?\\bcontent_id=\n                            )\n                            (?P<id>n?\\d+)|\n                            (?:[^/]+/)*(?P<path>[^/]+)\n                        )\n                    \n \n# From http://m.mlb.com/news/article/118550098/blue-jays-kevin-pillar-goes-spidey-up-the-wall-to-rob-tim-beckham-of-a-homer\n#',\n", "content": "from __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    parse_duration,\n    parse_iso8601,\n)\n\n\nclass MLBIE(InfoExtractor):\n    _VALID_URL = r'''(?x)\n                    https?://\n                        (?:[\\da-z_-]+\\.)*mlb\\.com/\n                        (?:\n                            (?:\n                                (?:.*?/)?video/(?:topic/[\\da-z_-]+/)?(?:v|.*?/c-)|\n                                (?:\n                                    shared/video/embed/(?:embed|m-internal-embed)\\.html|\n                                    (?:[^/]+/)+(?:play|index)\\.jsp|\n                                )\\?.*?\\bcontent_id=\n                            )\n                            (?P<id>n?\\d+)|\n                            (?:[^/]+/)*(?P<path>[^/]+)\n                        )\n                    '''\n    _TESTS = [\n        {\n            'url': 'http://m.mlb.com/sea/video/topic/51231442/v34698933/nymsea-ackley-robs-a-home-run-with-an-amazing-catch/?c_id=sea',\n            'md5': 'ff56a598c2cf411a9a38a69709e97079',\n            'info_dict': {\n                'id': '34698933',\n                'ext': 'mp4',\n                'title': \"Ackley's spectacular catch\",\n                'description': 'md5:7f5a981eb4f3cbc8daf2aeffa2215bf0',\n                'duration': 66,\n                'timestamp': 1405980600,\n                'upload_date': '20140721',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/video/topic/81536970/v34496663/mianym-stanton-practices-for-the-home-run-derby',\n            'md5': 'd9c022c10d21f849f49c05ae12a8a7e9',\n            'info_dict': {\n                'id': '34496663',\n                'ext': 'mp4',\n                'title': 'Stanton prepares for Derby',\n                'description': 'md5:d00ce1e5fd9c9069e9c13ab4faedfa57',\n                'duration': 46,\n                'timestamp': 1405105800,\n                'upload_date': '20140711',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/video/topic/vtp_hrd_sponsor/v34578115/hrd-cespedes-wins-2014-gillette-home-run-derby',\n            'md5': '0e6e73d509321e142409b695eadd541f',\n            'info_dict': {\n                'id': '34578115',\n                'ext': 'mp4',\n                'title': 'Cespedes repeats as Derby champ',\n                'description': 'md5:08df253ce265d4cf6fb09f581fafad07',\n                'duration': 488,\n                'timestamp': 1405399936,\n                'upload_date': '20140715',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/video/v34577915/bautista-on-derby-captaining-duties-his-performance',\n            'md5': 'b8fd237347b844365d74ea61d4245967',\n            'info_dict': {\n                'id': '34577915',\n                'ext': 'mp4',\n                'title': 'Bautista on Home Run Derby',\n                'description': 'md5:b80b34031143d0986dddc64a8839f0fb',\n                'duration': 52,\n                'timestamp': 1405390722,\n                'upload_date': '20140715',\n                'thumbnail': r're:^https?://.*\\.jpg$',\n            },\n        },\n        {\n            'url': 'http://m.mlb.com/news/article/118550098/blue-jays-kevin-pillar-goes-spidey-up-the-wall-to-rob-tim-beckham-of-a-homer',\n            'md5': 'aafaf5b0186fee8f32f20508092f8111',\n            'info_dict': {\n                'id': '75609783',\n                'ext': 'mp4',\n                'title': 'Must C: Pillar climbs for catch',\n                'description': '4/15/15: Blue Jays outfielder Kevin Pillar continues his defensive dominance by climbing the wall in left to rob Tim Beckham of a home run',\n                'timestamp': 1429124820,\n                'upload_date': '20150415',\n            }\n        },\n        {\n            'url': 'https://www.mlb.com/video/hargrove-homers-off-caldwell/c-1352023483?tid=67793694',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://m.mlb.com/shared/video/embed/embed.html?content_id=35692085&topic_id=6479266&width=400&height=224&property=mlb',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://mlb.mlb.com/shared/video/embed/embed.html?content_id=36599553',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://mlb.mlb.com/es/video/play.jsp?content_id=36599553',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://m.cardinals.mlb.com/stl/video/v51175783/atlstl-piscotty-makes-great-sliding-catch-on-line/?partnerId=as_mlb_20150321_42500876&adbid=579409712979910656&adbpl=tw&adbpr=52847728',\n            'only_matching': True,\n        },\n        {\n            # From http://m.mlb.com/news/article/118550098/blue-jays-kevin-pillar-goes-spidey-up-the-wall-to-rob-tim-beckham-of-a-homer\n            'url': 'http://mlb.mlb.com/shared/video/embed/m-internal-embed.html?content_id=75609783&property=mlb&autoplay=true&hashmode=false&siteSection=mlb/multimedia/article_118550098/article_embed&club=mlb',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://washington.nationals.mlb.com/mlb/gameday/index.jsp?c_id=was&gid=2015_05_09_atlmlb_wasmlb_1&lang=en&content_id=108309983&mode=video#',\n            'only_matching': True,\n        }\n    ]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        video_id = mobj.group('id')\n\n        if not video_id:\n            video_path = mobj.group('path')\n            webpage = self._download_webpage(url, video_path)\n            video_id = self._search_regex(\n                [r'data-video-?id=\"(\\d+)\"', r'content_id=(\\d+)'], webpage, 'video id')\n\n        detail = self._download_xml(\n            'http://m.mlb.com/gen/multimedia/detail/%s/%s/%s/%s.xml'\n            % (video_id[-3], video_id[-2], video_id[-1], video_id), video_id)\n\n        title = detail.find('./headline').text\n        description = detail.find('./big-blurb').text\n        duration = parse_duration(detail.find('./duration').text)\n        timestamp = parse_iso8601(detail.attrib['date'][:-5])\n\n        thumbnails = [{\n            'url': thumbnail.text,\n        } for thumbnail in detail.findall('./thumbnailScenarios/thumbnailScenario')]\n\n        formats = []\n        for media_url in detail.findall('./url'):\n            playback_scenario = media_url.attrib['playback_scenario']\n            fmt = {\n                'url': media_url.text,\n                'format_id': playback_scenario,\n            }\n            m = re.search(r'(?P<vbr>\\d+)K_(?P<width>\\d+)X(?P<height>\\d+)', playback_scenario)\n            if m:\n                fmt.update({\n                    'vbr': int(m.group('vbr')) * 1000,\n                    'width': int(m.group('width')),\n                    'height': int(m.group('height')),\n                })\n            formats.append(fmt)\n\n        self._sort_formats(formats)\n\n        return {\n            'id': video_id,\n            'title': title,\n            'description': description,\n            'duration': duration,\n            'timestamp': timestamp,\n            'formats': formats,\n            'thumbnails': thumbnails,\n        }\n", "description": "Command-line program to download videos from YouTube.com and other video sites", "file_name": "mlb.py", "language": "Python", "project_name": "youtube-dl", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/rg3_youtube-dl/rg3-youtube-dl-6202f08/youtube_dl/extractor/mlb.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:18:39Z", "url": "https://github.com/rg3/youtube-dl", "wiki": false}