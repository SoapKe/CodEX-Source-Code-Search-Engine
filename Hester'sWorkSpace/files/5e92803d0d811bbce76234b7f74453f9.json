{"author": "odoo", "code": "# -*- coding: utf-8 -*-\n\n\nfrom lxml import etree as ElementTree\n\nfrom odoo.http import Controller, route, request\n\n\nclass Board(Controller):\n\n    @route('/board/add_to_dashboard', type='json', auth='user')\n    def add_to_dashboard(self, action_id, context_to_save, domain, view_mode, name=''):\n        \n        action = request.env.ref('board.open_board_my_dash_action')\n\n        if action and action['res_model'] == 'board.board' and action['views'][0][1] == 'form' and action_id:\n            ?\n            view_id = action['views'][0][0]\n            board = request.env['board.board'].fields_view_get(view_id, 'form')\n            if board and 'arch' in board:\n                xml = ElementTree.fromstring(board['arch'])\n                column = xml.find('./board/column')\n                if column is not None:\n                    new_action = ElementTree.Element('action', {\n                        'name': str(action_id),\n                        'string': name,\n                        'view_mode': view_mode,\n                        'context': str(context_to_save),\n                        'domain': str(domain)\n                    })\n                    column.insert(0, new_action)\n                    arch = ElementTree.tostring(xml, encoding='unicode')\n                    request.env['ir.ui.view.custom'].create({\n                        'user_id': request.session.uid,\n                        'ref_id': view_id,\n                        'arch': arch\n                    })\n                    return True\n\n        return False\n", "comments": "      coding  utf 8        part odoo  see license file full copyright licensing details     retrieve  my dashboard  action xmlid    maybe check content instead model board board   ", "content": "# -*- coding: utf-8 -*-\n# Part of Odoo. See LICENSE file for full copyright and licensing details.\n\nfrom lxml import etree as ElementTree\n\nfrom odoo.http import Controller, route, request\n\n\nclass Board(Controller):\n\n    @route('/board/add_to_dashboard', type='json', auth='user')\n    def add_to_dashboard(self, action_id, context_to_save, domain, view_mode, name=''):\n        # Retrieve the 'My Dashboard' action from its xmlid\n        action = request.env.ref('board.open_board_my_dash_action')\n\n        if action and action['res_model'] == 'board.board' and action['views'][0][1] == 'form' and action_id:\n            # Maybe should check the content instead of model board.board ?\n            view_id = action['views'][0][0]\n            board = request.env['board.board'].fields_view_get(view_id, 'form')\n            if board and 'arch' in board:\n                xml = ElementTree.fromstring(board['arch'])\n                column = xml.find('./board/column')\n                if column is not None:\n                    new_action = ElementTree.Element('action', {\n                        'name': str(action_id),\n                        'string': name,\n                        'view_mode': view_mode,\n                        'context': str(context_to_save),\n                        'domain': str(domain)\n                    })\n                    column.insert(0, new_action)\n                    arch = ElementTree.tostring(xml, encoding='unicode')\n                    request.env['ir.ui.view.custom'].create({\n                        'user_id': request.session.uid,\n                        'ref_id': view_id,\n                        'arch': arch\n                    })\n                    return True\n\n        return False\n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "main.py", "id": "5e92803d0d811bbce76234b7f74453f9", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/board/controllers/main.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}