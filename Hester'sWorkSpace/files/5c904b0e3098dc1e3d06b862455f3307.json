{"author": "odoo", "code": "# -*- coding: utf-8 -*-\n\n\nfrom odoo.tests import common\n\n\nclass TestMrpMulticompany(common.TransactionCase):\n\n    def setUp(self):\n        super(TestMrpMulticompany, self).setUp()\n\n        group_user = self.env.ref('base.group_user')\n        group_stock_manager = self.env.ref('stock.group_stock_manager')\n        company_2 = self.env.ref('stock.res_company_1')\n        self.multicompany_user_id = self.env['res.users'].create({\n            'name': 'multicomp',\n            'login': 'multicomp',\n            'groups_id': [(6, 0, [group_user.id, group_stock_manager.id])],\n            'company_id': company_2.id,\n            'company_ids': [(6, 0, [company_2.id])]\n        })\n\n    def test_00_multicompany_user(self):\n        \n        StockLocation = self.env['stock.location'].sudo(self.multicompany_user_id)\n        fields = ['location_src_id', 'location_dest_id']\n        defaults = StockLocation.default_get(['location_id', 'location_dest_id', 'type'])\n        for field in fields:\n            if defaults.get(field):\n                try:\n                    StockLocation.check_access_rule([defaults[field]], 'read')\n                except Exception as exc:\n                    assert False, \"unreadable location %s: %s\" % (field, exc)\n", "comments": "   check error getting default mrp production values multicompany setting           coding  utf 8        part odoo  see license file full copyright licensing details  ", "content": "# -*- coding: utf-8 -*-\n# Part of Odoo. See LICENSE file for full copyright and licensing details.\n\nfrom odoo.tests import common\n\n\nclass TestMrpMulticompany(common.TransactionCase):\n\n    def setUp(self):\n        super(TestMrpMulticompany, self).setUp()\n\n        group_user = self.env.ref('base.group_user')\n        group_stock_manager = self.env.ref('stock.group_stock_manager')\n        company_2 = self.env.ref('stock.res_company_1')\n        self.multicompany_user_id = self.env['res.users'].create({\n            'name': 'multicomp',\n            'login': 'multicomp',\n            'groups_id': [(6, 0, [group_user.id, group_stock_manager.id])],\n            'company_id': company_2.id,\n            'company_ids': [(6, 0, [company_2.id])]\n        })\n\n    def test_00_multicompany_user(self):\n        \"\"\"check no error on getting default mrp.production values in multicompany setting\"\"\"\n        StockLocation = self.env['stock.location'].sudo(self.multicompany_user_id)\n        fields = ['location_src_id', 'location_dest_id']\n        defaults = StockLocation.default_get(['location_id', 'location_dest_id', 'type'])\n        for field in fields:\n            if defaults.get(field):\n                try:\n                    StockLocation.check_access_rule([defaults[field]], 'read')\n                except Exception as exc:\n                    assert False, \"unreadable location %s: %s\" % (field, exc)\n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "test_multicompany.py", "id": "5c904b0e3098dc1e3d06b862455f3307", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/mrp/tests/test_multicompany.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}