{"author": "yandex", "code": "import gixy\nfrom gixy.plugins.plugin import Plugin\n\n\nclass host_spoofing(Plugin):\n    \"\"\"\n    Insecure example:\n        proxy_set_header Host $http_host\n    \"\"\"\n    summary = 'The proxied Host header may be spoofed.'\n    severity = gixy.severity.MEDIUM\n    description = 'In most cases \"$host\" variable are more appropriate, just use it.'\n    help_url = 'https://github.com/yandex/gixy/blob/master/docs/en/plugins/hostspoofing.md'\n    directives = ['proxy_set_header']\n\n    def audit(self, directive):\n        name, value = directive.args\n        if name.lower() != 'host':\n            \n            return\n\n        if value == '$http_host' or value.startswith('$arg_'):\n            self.add_issue(directive=directive)\n", "comments": "        insecure example          proxy set header host  http host            not  host  header ", "content": "import gixy\nfrom gixy.plugins.plugin import Plugin\n\n\nclass host_spoofing(Plugin):\n    \"\"\"\n    Insecure example:\n        proxy_set_header Host $http_host\n    \"\"\"\n    summary = 'The proxied Host header may be spoofed.'\n    severity = gixy.severity.MEDIUM\n    description = 'In most cases \"$host\" variable are more appropriate, just use it.'\n    help_url = 'https://github.com/yandex/gixy/blob/master/docs/en/plugins/hostspoofing.md'\n    directives = ['proxy_set_header']\n\n    def audit(self, directive):\n        name, value = directive.args\n        if name.lower() != 'host':\n            # Not a \"Host\" header\n            return\n\n        if value == '$http_host' or value.startswith('$arg_'):\n            self.add_issue(directive=directive)\n", "description": "Nginx configuration static analyzer", "file_name": "host_spoofing.py", "id": "4a508e0a4a768aece385e16e4ca20aa8", "language": "Python", "project_name": "gixy", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/yandex-gixy/yandex-gixy-86b5e60/gixy/plugins/host_spoofing.py", "save_time": "", "source": "", "update_at": "2018-03-17T23:01:42Z", "url": "https://github.com/yandex/gixy", "wiki": true}