{"author": "geekcomputers", "code": "\n\n\n\n\n\n\n\n\n\nimport os\t\t\t\t\t\nimport optparse\t\t\t\nfrom _winreg import *\t\n\ndef sid2user(sid):\t\t\n  try:\n    key = OpenKey(HKEY_LOCAL_MACHINE, \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\" + '\\\\' + sid)\n    (value, type) = QueryValueEx(key, 'ProfileImagePath')\n    user = value.split('\\\\')[-1]\n    return user\n  except:\n    return sid\n\n\ndef returnDir():\t\t\t\n  dirs=['c:\\\\Recycler\\\\','C:\\\\Recycled\\\\','C:\\\\$RECYCLE.BIN\\\\']\n  #dirs=['c:\\\\$RECYCLE.BIN\\\\']\n  for recycleDir in dirs:\n    if os.path.isdir(recycleDir):\n      return recycleDir\n  return None\n  \ndef findRecycled(recycleDir):\t\n  dirList = os.listdir(recycleDir)\n  for sid in dirList:\n    files = os.listdir(recycleDir + sid)\n    user = sid2user(sid)\n    print '\\n[*] Listing Files for User: ' + str(user)\n    for file in files:\n      print '[+] Found File: ' + str(file)\n\ndef main():\n  recycleDir = returnDir()\n  findRecycled(recycleDir)\n  \nif __name__ == '__main__':\n  main()", "comments": "  script name    recyclebin py    author      craig richards    created      07th june 2013    last modified        version      1 0    modifications        description     scans recyclebin displays files  originally got script violent python book    load module    load module    load module    start function gather user    start function search recyclebin   dirs   c    recycle bin        start function  list contents recyclebin ", "content": "# Script Name\t\t: recyclebin.py\n# Author\t\t\t\t: Craig Richards\n# Created\t\t\t\t: 07th June 2013\n# Last Modified\t\t: \n# Version\t\t\t\t: 1.0\n\n# Modifications\t\t: \n\n# Description\t\t\t: Scans the recyclebin and displays the files in there, originally got this script from the Violent Python book\n\nimport os\t\t\t\t\t# Load the Module\nimport optparse\t\t\t# Load the Module\nfrom _winreg import *\t# Load the Module\n\ndef sid2user(sid):\t\t# Start of the function to gather the user\n  try:\n    key = OpenKey(HKEY_LOCAL_MACHINE, \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\" + '\\\\' + sid)\n    (value, type) = QueryValueEx(key, 'ProfileImagePath')\n    user = value.split('\\\\')[-1]\n    return user\n  except:\n    return sid\n\n\ndef returnDir():\t\t\t# Start of the function to search through the recyclebin\n  dirs=['c:\\\\Recycler\\\\','C:\\\\Recycled\\\\','C:\\\\$RECYCLE.BIN\\\\']\n  #dirs=['c:\\\\$RECYCLE.BIN\\\\']\n  for recycleDir in dirs:\n    if os.path.isdir(recycleDir):\n      return recycleDir\n  return None\n  \ndef findRecycled(recycleDir):\t# Start of the function, list the contents of the recyclebin\n  dirList = os.listdir(recycleDir)\n  for sid in dirList:\n    files = os.listdir(recycleDir + sid)\n    user = sid2user(sid)\n    print '\\n[*] Listing Files for User: ' + str(user)\n    for file in files:\n      print '[+] Found File: ' + str(file)\n\ndef main():\n  recycleDir = returnDir()\n  findRecycled(recycleDir)\n  \nif __name__ == '__main__':\n  main()", "description": "My Python Examples", "file_name": "recyclebin.py", "id": "2cb6971d10bd0677b7a8113e5cab7cda", "language": "Python", "project_name": "Python", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/geekcomputers-Python/geekcomputers-Python-ef88c96/recyclebin.py", "save_time": "", "source": "", "update_at": "2018-03-18T16:41:16Z", "url": "https://github.com/geekcomputers/Python", "wiki": true}