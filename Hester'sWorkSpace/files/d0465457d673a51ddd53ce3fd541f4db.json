{"author": "odoo", "code": "# -*- coding: utf-8 -*-\nfrom odoo import http\nfrom odoo.http import request\nfrom odoo.addons.website_sale.controllers.main import WebsiteSale\nimport json\n\n\nclass WebsiteSaleWishlist(WebsiteSale):\n\n    @http.route(['/shop/wishlist/add'], type='json', auth=\"public\", website=True)\n    def add_to_wishlist(self, product_id, price=False, **kw):\n        if not price:\n            compute_currency, pricelist_context, pl = self._get_compute_currency_and_context()\n            p = request.env['product.product'].with_context(pricelist_context, display_default_code=False).browse(product_id)\n            price = p.website_price\n\n        partner_id = session = False\n        if not request.website.is_public_user():\n            partner_id = request.env.user.partner_id.id\n        else:\n            session = request.session.sid\n        return request.env['product.wishlist']._add_to_wishlist(\n            pl.id,\n            pl.currency_id.id,\n            request.website.id,\n            price,\n            product_id,\n            partner_id,\n            session\n        )\n\n    @http.route(['/shop/wishlist'], type='http', auth=\"public\", website=True)\n    def get_wishlist(self, count=False, **kw):\n        values = request.env['product.wishlist'].with_context(display_default_code=False).current()\n        if count:\n            return request.make_response(json.dumps(values.mapped('product_id').ids))\n\n        if not len(values):\n            return request.redirect(\"/shop\")\n\n        return request.render(\"website_sale_wishlist.product_wishlist\", dict(wishes=values))\n", "comments": "      coding  utf 8     ", "content": "# -*- coding: utf-8 -*-\nfrom odoo import http\nfrom odoo.http import request\nfrom odoo.addons.website_sale.controllers.main import WebsiteSale\nimport json\n\n\nclass WebsiteSaleWishlist(WebsiteSale):\n\n    @http.route(['/shop/wishlist/add'], type='json', auth=\"public\", website=True)\n    def add_to_wishlist(self, product_id, price=False, **kw):\n        if not price:\n            compute_currency, pricelist_context, pl = self._get_compute_currency_and_context()\n            p = request.env['product.product'].with_context(pricelist_context, display_default_code=False).browse(product_id)\n            price = p.website_price\n\n        partner_id = session = False\n        if not request.website.is_public_user():\n            partner_id = request.env.user.partner_id.id\n        else:\n            session = request.session.sid\n        return request.env['product.wishlist']._add_to_wishlist(\n            pl.id,\n            pl.currency_id.id,\n            request.website.id,\n            price,\n            product_id,\n            partner_id,\n            session\n        )\n\n    @http.route(['/shop/wishlist'], type='http', auth=\"public\", website=True)\n    def get_wishlist(self, count=False, **kw):\n        values = request.env['product.wishlist'].with_context(display_default_code=False).current()\n        if count:\n            return request.make_response(json.dumps(values.mapped('product_id').ids))\n\n        if not len(values):\n            return request.redirect(\"/shop\")\n\n        return request.render(\"website_sale_wishlist.product_wishlist\", dict(wishes=values))\n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "main.py", "id": "d0465457d673a51ddd53ce3fd541f4db", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/website_sale_wishlist/controllers/main.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}