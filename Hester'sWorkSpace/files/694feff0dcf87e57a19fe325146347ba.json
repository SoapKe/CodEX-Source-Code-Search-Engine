{"author": "odoo", "code": "# -*- coding: utf-8 -*-\n\n\nimport werkzeug\n\nfrom odoo import http\nfrom odoo.http import request\nfrom odoo.tools.translate import _\n\n\nclass Rating(http.Controller):\n\n    @http.route('/rating/<string:token>/<int:rate>', type='http', auth=\"public\")\n    def open_rating(self, token, rate, **kwargs):\n        assert rate in (1, 5, 10), \"Incorrect rating\"\n        rating = request.env['rating.rating'].sudo().search([('access_token', '=', token)])\n        if not rating:\n            return request.not_found()\n        rate_names={\n            5: _(\"not satisfied\"),\n            1: _(\"highly dissatisfied\"),\n            10: _(\"satisfied\")\n        }\n        rating.write({'rating': rate, 'consumed': True})\n        lang = rating.partner_id.lang or 'en_US'\n        return request.env['ir.ui.view'].with_context(lang=lang).render_template('rating.rating_external_page_submit', {\n            'rating': rating, 'token': token,\n            'rate_name': rate_names[rate], 'rate': rate\n        })\n\n    @http.route(['/rating/<string:token>/<int:rate>/submit_feedback'], type=\"http\", auth=\"public\", methods=['post'])\n    def submit_rating(self, token, rate, **kwargs):\n        rating = request.env['rating.rating'].sudo().search([('access_token', '=', token)])\n        if not rating:\n            return request.not_found()\n        record_sudo = request.env[rating.res_model].sudo().browse(rating.res_id)\n        record_sudo.rating_apply(rate, token=token, feedback=kwargs.get('feedback'))\n        lang = rating.partner_id.lang or 'en_US'\n        return request.env['ir.ui.view'].with_context(lang=lang).render_template('rating.rating_external_page_view', {\n            'web_base_url': request.env['ir.config_parameter'].sudo().get_param('web.base.url'),\n            'rating': rating,\n        })\n", "comments": "      coding  utf 8        part odoo  see license file full copyright licensing details  ", "content": "# -*- coding: utf-8 -*-\n# Part of Odoo. See LICENSE file for full copyright and licensing details.\n\nimport werkzeug\n\nfrom odoo import http\nfrom odoo.http import request\nfrom odoo.tools.translate import _\n\n\nclass Rating(http.Controller):\n\n    @http.route('/rating/<string:token>/<int:rate>', type='http', auth=\"public\")\n    def open_rating(self, token, rate, **kwargs):\n        assert rate in (1, 5, 10), \"Incorrect rating\"\n        rating = request.env['rating.rating'].sudo().search([('access_token', '=', token)])\n        if not rating:\n            return request.not_found()\n        rate_names={\n            5: _(\"not satisfied\"),\n            1: _(\"highly dissatisfied\"),\n            10: _(\"satisfied\")\n        }\n        rating.write({'rating': rate, 'consumed': True})\n        lang = rating.partner_id.lang or 'en_US'\n        return request.env['ir.ui.view'].with_context(lang=lang).render_template('rating.rating_external_page_submit', {\n            'rating': rating, 'token': token,\n            'rate_name': rate_names[rate], 'rate': rate\n        })\n\n    @http.route(['/rating/<string:token>/<int:rate>/submit_feedback'], type=\"http\", auth=\"public\", methods=['post'])\n    def submit_rating(self, token, rate, **kwargs):\n        rating = request.env['rating.rating'].sudo().search([('access_token', '=', token)])\n        if not rating:\n            return request.not_found()\n        record_sudo = request.env[rating.res_model].sudo().browse(rating.res_id)\n        record_sudo.rating_apply(rate, token=token, feedback=kwargs.get('feedback'))\n        lang = rating.partner_id.lang or 'en_US'\n        return request.env['ir.ui.view'].with_context(lang=lang).render_template('rating.rating_external_page_view', {\n            'web_base_url': request.env['ir.config_parameter'].sudo().get_param('web.base.url'),\n            'rating': rating,\n        })\n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "main.py", "id": "694feff0dcf87e57a19fe325146347ba", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/rating/controllers/main.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}