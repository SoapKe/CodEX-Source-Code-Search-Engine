{"author": "rg3", "code": "\nfrom __future__ import unicode_literals\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    float_or_none,\n    int_or_none,\n    parse_iso8601,\n    sanitized_Request,\n)\n\n\nclass EitbIE(InfoExtractor):\n    IE_NAME = 'eitb.tv'\n    _VALID_URL = r'https?://(?:www\\.)?eitb\\.tv/(?:eu/bideoa|es/video)/[^/]+/\\d+/(?P<id>\\d+)'\n\n    _TEST = {\n        'url': 'http://www.eitb.tv/es/video/60-minutos-60-minutos-2013-2014/4104995148001/4090227752001/lasa-y-zabala-30-anos/',\n        'md5': 'edf4436247185adee3ea18ce64c47998',\n        'info_dict': {\n            'id': '4090227752001',\n            'ext': 'mp4',\n            'title': '60 minutos (Lasa y Zabala, 30 a\u00f1os)',\n            'description': 'Programa de reportajes de actualidad.',\n            'duration': 3996.76,\n            'timestamp': 1381789200,\n            'upload_date': '20131014',\n            'tags': list,\n        },\n    }\n\n    def _real_extract(self, url):\n        video_id = self._match_id(url)\n\n        video = self._download_json(\n            'http://mam.eitb.eus/mam/REST/ServiceMultiweb/Video/MULTIWEBTV/%s/' % video_id,\n            video_id, 'Downloading video JSON')\n\n        media = video['web_media'][0]\n\n        formats = []\n        for rendition in media['RENDITIONS']:\n            video_url = rendition.get('PMD_URL')\n            if not video_url:\n                continue\n            tbr = float_or_none(rendition.get('ENCODING_RATE'), 1000)\n            format_id = 'http'\n            if tbr:\n                format_id += '-%d' % int(tbr)\n            formats.append({\n                'url': rendition['PMD_URL'],\n                'format_id': format_id,\n                'width': int_or_none(rendition.get('FRAME_WIDTH')),\n                'height': int_or_none(rendition.get('FRAME_HEIGHT')),\n                'tbr': tbr,\n            })\n\n        hls_url = media.get('HLS_SURL')\n        if hls_url:\n            request = sanitized_Request(\n                'http://mam.eitb.eus/mam/REST/ServiceMultiweb/DomainRestrictedSecurity/TokenAuth/',\n                headers={'Referer': url})\n            token_data = self._download_json(\n                request, video_id, 'Downloading auth token', fatal=False)\n            if token_data:\n                token = token_data.get('token')\n                if token:\n                    formats.extend(self._extract_m3u8_formats(\n                        '%s?hdnts=%s' % (hls_url, token), video_id, m3u8_id='hls', fatal=False))\n\n        hds_url = media.get('HDS_SURL')\n        if hds_url:\n            formats.extend(self._extract_f4m_formats(\n                '%s?hdcore=3.7.0' % hds_url.replace('euskalsvod', 'euskalvod'),\n                video_id, f4m_id='hds', fatal=False))\n\n        self._sort_formats(formats)\n\n        return {\n            'id': video_id,\n            'title': media.get('NAME_ES') or media.get('name') or media['NAME_EU'],\n            'description': media.get('SHORT_DESC_ES') or video.get('desc_group') or media.get('SHORT_DESC_EU'),\n            'thumbnail': media.get('STILL_URL') or media.get('THUMBNAIL_URL'),\n            'duration': float_or_none(media.get('LENGTH'), 1000),\n            'timestamp': parse_iso8601(media.get('BROADCST_DATE'), ' '),\n            'tags': media.get('TAGS'),\n            'formats': formats,\n        }\n", "comments": "# coding: utf-8\n", "content": "# coding: utf-8\nfrom __future__ import unicode_literals\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    float_or_none,\n    int_or_none,\n    parse_iso8601,\n    sanitized_Request,\n)\n\n\nclass EitbIE(InfoExtractor):\n    IE_NAME = 'eitb.tv'\n    _VALID_URL = r'https?://(?:www\\.)?eitb\\.tv/(?:eu/bideoa|es/video)/[^/]+/\\d+/(?P<id>\\d+)'\n\n    _TEST = {\n        'url': 'http://www.eitb.tv/es/video/60-minutos-60-minutos-2013-2014/4104995148001/4090227752001/lasa-y-zabala-30-anos/',\n        'md5': 'edf4436247185adee3ea18ce64c47998',\n        'info_dict': {\n            'id': '4090227752001',\n            'ext': 'mp4',\n            'title': '60 minutos (Lasa y Zabala, 30 a\u00f1os)',\n            'description': 'Programa de reportajes de actualidad.',\n            'duration': 3996.76,\n            'timestamp': 1381789200,\n            'upload_date': '20131014',\n            'tags': list,\n        },\n    }\n\n    def _real_extract(self, url):\n        video_id = self._match_id(url)\n\n        video = self._download_json(\n            'http://mam.eitb.eus/mam/REST/ServiceMultiweb/Video/MULTIWEBTV/%s/' % video_id,\n            video_id, 'Downloading video JSON')\n\n        media = video['web_media'][0]\n\n        formats = []\n        for rendition in media['RENDITIONS']:\n            video_url = rendition.get('PMD_URL')\n            if not video_url:\n                continue\n            tbr = float_or_none(rendition.get('ENCODING_RATE'), 1000)\n            format_id = 'http'\n            if tbr:\n                format_id += '-%d' % int(tbr)\n            formats.append({\n                'url': rendition['PMD_URL'],\n                'format_id': format_id,\n                'width': int_or_none(rendition.get('FRAME_WIDTH')),\n                'height': int_or_none(rendition.get('FRAME_HEIGHT')),\n                'tbr': tbr,\n            })\n\n        hls_url = media.get('HLS_SURL')\n        if hls_url:\n            request = sanitized_Request(\n                'http://mam.eitb.eus/mam/REST/ServiceMultiweb/DomainRestrictedSecurity/TokenAuth/',\n                headers={'Referer': url})\n            token_data = self._download_json(\n                request, video_id, 'Downloading auth token', fatal=False)\n            if token_data:\n                token = token_data.get('token')\n                if token:\n                    formats.extend(self._extract_m3u8_formats(\n                        '%s?hdnts=%s' % (hls_url, token), video_id, m3u8_id='hls', fatal=False))\n\n        hds_url = media.get('HDS_SURL')\n        if hds_url:\n            formats.extend(self._extract_f4m_formats(\n                '%s?hdcore=3.7.0' % hds_url.replace('euskalsvod', 'euskalvod'),\n                video_id, f4m_id='hds', fatal=False))\n\n        self._sort_formats(formats)\n\n        return {\n            'id': video_id,\n            'title': media.get('NAME_ES') or media.get('name') or media['NAME_EU'],\n            'description': media.get('SHORT_DESC_ES') or video.get('desc_group') or media.get('SHORT_DESC_EU'),\n            'thumbnail': media.get('STILL_URL') or media.get('THUMBNAIL_URL'),\n            'duration': float_or_none(media.get('LENGTH'), 1000),\n            'timestamp': parse_iso8601(media.get('BROADCST_DATE'), ' '),\n            'tags': media.get('TAGS'),\n            'formats': formats,\n        }\n", "description": "Command-line program to download videos from YouTube.com and other video sites", "file_name": "eitb.py", "language": "Python", "project_name": "youtube-dl", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/rg3_youtube-dl/rg3-youtube-dl-6202f08/youtube_dl/extractor/eitb.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:18:39Z", "url": "https://github.com/rg3/youtube-dl", "wiki": false}