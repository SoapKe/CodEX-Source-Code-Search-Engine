{"author": "rg3", "code": "\nfrom __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..compat import (\n    compat_parse_qs,\n    compat_str,\n    compat_urllib_parse_urlparse,\n)\nfrom ..utils import (\n    urljoin,\n    int_or_none,\n    parse_codecs,\n    try_get,\n)\n\n\ndef _raw_id(src_url):\n    return compat_urllib_parse_urlparse(src_url).path.split('/')[-1]\n\n\nclass SeznamZpravyIE(InfoExtractor):\n    _VALID_URL = r'https?://(?:www\\.)?seznamzpravy\\.cz/iframe/player\\?.*\\bsrc='\n    _TESTS = [{\n        'url': 'https://www.seznamzpravy.cz/iframe/player?duration=241&serviceSlug=zpravy&src=https%3A%2F%2Fv39-a.sdn.szn.cz%2Fv_39%2Fvmd%2F5999c902ea707c67d8e267a9%3Ffl%3Dmdk%2C432f65a0%7C&itemType=video&autoPlay=false&title=Sv%C4%9Bt%20bez%20obalu%3A%20%C4%8Ce%C5%A1t%C3%AD%20voj%C3%A1ci%20na%20mis%C3%ADch%20(kr%C3%A1tk%C3%A1%20verze)&series=Sv%C4%9Bt%20bez%20obalu&serviceName=Seznam%20Zpr%C3%A1vy&poster=%2F%2Fd39-a.sdn.szn.cz%2Fd_39%2Fc_img_F_I%2FR5puJ.jpeg%3Ffl%3Dcro%2C0%2C0%2C1920%2C1080%7Cres%2C1200%2C%2C1%7Cjpg%2C80%2C%2C1&width=1920&height=1080&cutFrom=0&cutTo=0&splVersion=VOD&contentId=170889&contextId=35990&showAdvert=true&collocation=&autoplayPossible=true&embed=&isVideoTooShortForPreroll=false&isVideoTooLongForPostroll=true&videoCommentOpKey=&videoCommentId=&version=4.0.76&dotService=zpravy&gemiusPrismIdentifier=bVc1ZIb_Qax4W2v5xOPGpMeCP31kFfrTzj0SqPTLh_b.Z7&zoneIdPreroll=seznam.pack.videospot&skipOffsetPreroll=5&sectionPrefixPreroll=%2Fzpravy',\n        'info_dict': {\n            'id': '170889',\n            'ext': 'mp4',\n            'title': 'Sv\u011bt bez obalu: \u010ce\u0161t\u00ed voj\u00e1ci na mis\u00edch (kr\u00e1tk\u00e1 verze)',\n            'thumbnail': r're:^https?://.*\\.jpe?g',\n            'duration': 241,\n            'series': 'Sv\u011bt bez obalu',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        \n        'url': 'https://www.seznamzpravy.cz/iframe/player?duration=null&serviceSlug=zpravy&src=https%3A%2F%2Flive-a.sdn.szn.cz%2Fv_39%2F59e468fe454f8472a96af9fa%3Ffl%3Dmdk%2C5c1e2840%7C&itemType=livevod&autoPlay=false&title=P%C5%99edseda%20KDU-%C4%8CSL%20Pavel%20B%C4%9Blobr%C3%A1dek%20ve%20volebn%C3%AD%20V%C3%BDzv%C4%9B%20Seznamu&series=V%C3%BDzva&serviceName=Seznam%20Zpr%C3%A1vy&poster=%2F%2Fd39-a.sdn.szn.cz%2Fd_39%2Fc_img_G_J%2FjTBCs.jpeg%3Ffl%3Dcro%2C0%2C0%2C1280%2C720%7Cres%2C1200%2C%2C1%7Cjpg%2C80%2C%2C1&width=16&height=9&cutFrom=0&cutTo=0&splVersion=VOD&contentId=185688&contextId=38489&showAdvert=true&collocation=&hideFullScreen=false&hideSubtitles=false&embed=&isVideoTooShortForPreroll=false&isVideoTooShortForPreroll2=false&isVideoTooLongForPostroll=false&fakePostrollZoneID=seznam.clanky.zpravy.preroll&fakePrerollZoneID=seznam.clanky.zpravy.preroll&videoCommentId=&trim=default_16x9&noPrerollVideoLength=30&noPreroll2VideoLength=undefined&noMidrollVideoLength=0&noPostrollVideoLength=999999&autoplayPossible=true&version=5.0.41&dotService=zpravy&gemiusPrismIdentifier=zD3g7byfW5ekpXmxTVLaq5Srjw5i4hsYo0HY1aBwIe..27&zoneIdPreroll=seznam.pack.videospot&skipOffsetPreroll=5&sectionPrefixPreroll=%2Fzpravy%2Fvyzva&zoneIdPostroll=seznam.pack.videospot&skipOffsetPostroll=5&sectionPrefixPostroll=%2Fzpravy%2Fvyzva&regression=false',\n        'info_dict': {\n            'id': '185688',\n            'ext': 'mp4',\n            'title': 'P\u0159edseda KDU-\u010cSL Pavel B\u011blobr\u00e1dek ve volebn\u00ed V\u00fdzv\u011b Seznamu',\n            'thumbnail': r're:^https?://.*\\.jpe?g',\n            'series': 'V\u00fdzva',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }]\n\n    @staticmethod\n    def _extract_urls(webpage):\n        return [\n            mobj.group('url') for mobj in re.finditer(\n                r'<iframe\\b[^>]+\\bsrc=([\"\\'])(?P<url>(?:https?:)?//(?:www\\.)?seznamzpravy\\.cz/iframe/player\\?.*?)\\1',\n                webpage)]\n\n    def _extract_sdn_formats(self, sdn_url, video_id):\n        sdn_data = self._download_json(sdn_url, video_id)\n\n        if sdn_data.get('Location'):\n            sdn_url = sdn_data['Location']\n            sdn_data = self._download_json(sdn_url, video_id)\n\n        formats = []\n        mp4_formats = try_get(sdn_data, lambda x: x['data']['mp4'], dict) or {}\n        for format_id, format_data in mp4_formats.items():\n            relative_url = format_data.get('url')\n            if not relative_url:\n                continue\n\n            try:\n                width, height = format_data.get('resolution')\n            except (TypeError, ValueError):\n                width, height = None, None\n\n            f = {\n                'url': urljoin(sdn_url, relative_url),\n                'format_id': 'http-%s' % format_id,\n                'tbr': int_or_none(format_data.get('bandwidth'), scale=1000),\n                'width': int_or_none(width),\n                'height': int_or_none(height),\n            }\n            f.update(parse_codecs(format_data.get('codec')))\n            formats.append(f)\n\n        pls = sdn_data.get('pls', {})\n\n        def get_url(format_id):\n            return try_get(pls, lambda x: x[format_id]['url'], compat_str)\n\n        dash_rel_url = get_url('dash')\n        if dash_rel_url:\n            formats.extend(self._extract_mpd_formats(\n                urljoin(sdn_url, dash_rel_url), video_id, mpd_id='dash',\n                fatal=False))\n\n        hls_rel_url = get_url('hls')\n        if hls_rel_url:\n            formats.extend(self._extract_m3u8_formats(\n                urljoin(sdn_url, hls_rel_url), video_id, ext='mp4',\n                m3u8_id='hls', fatal=False))\n\n        self._sort_formats(formats)\n        return formats\n\n    def _real_extract(self, url):\n        params = compat_parse_qs(compat_urllib_parse_urlparse(url).query)\n\n        src = params['src'][0]\n        title = params['title'][0]\n        video_id = params.get('contentId', [_raw_id(src)])[0]\n        formats = self._extract_sdn_formats(src + 'spl2,2,VOD', video_id)\n\n        duration = int_or_none(params.get('duration', [None])[0])\n        series = params.get('series', [None])[0]\n        thumbnail = params.get('poster', [None])[0]\n\n        return {\n            'id': video_id,\n            'title': title,\n            'thumbnail': thumbnail,\n            'duration': duration,\n            'series': series,\n            'formats': formats,\n        }\n\n\nclass SeznamZpravyArticleIE(InfoExtractor):\n    _VALID_URL = r'https?://(?:www\\.)?(?:seznam\\.cz/zpravy|seznamzpravy\\.cz)/clanek/(?:[^/?\n    _API_URL = 'https://apizpravy.seznam.cz/'\n\n    _TESTS = [{\n        \n        'url': 'https://www.seznamzpravy.cz/clanek/jejich-svet-na-nas-utoci-je-lepsi-branit-se-na-jejich-pisecku-rika-reziser-a-major-v-zaloze-marhoul-35990',\n        'info_dict': {\n            'id': '35990',\n            'title': 'md5:6011c877a36905f28f271fcd8dcdb0f2',\n            'description': 'md5:933f7b06fa337a814ba199d3596d27ba',\n        },\n        'playlist_count': 2,\n    }, {\n        \n        'url': 'https://www.seznam.cz/zpravy/clanek/znovu-do-vlady-s-ano-pavel-belobradek-ve-volebnim-specialu-seznamu-38489',\n        'info_dict': {\n            'id': '38489',\n            'title': 'md5:8fa1afdc36fd378cf0eba2b74c5aca60',\n            'description': 'md5:428e7926a1a81986ec7eb23078004fb4',\n        },\n        'playlist_count': 1,\n    }]\n\n    def _real_extract(self, url):\n        article_id = self._match_id(url)\n\n        webpage = self._download_webpage(url, article_id)\n\n        info = self._search_json_ld(webpage, article_id, default={})\n\n        title = info.get('title') or self._og_search_title(webpage, fatal=False)\n        description = info.get('description') or self._og_search_description(webpage)\n\n        return self.playlist_result([\n            self.url_result(url, ie=SeznamZpravyIE.ie_key())\n            for url in SeznamZpravyIE._extract_urls(webpage)],\n            article_id, title, description)\n", "comments": "# coding: utf-8\n# with Location key\n#&]+)-(?P<id>\\d+)'\n# two videos on one page, with SDN URL\n# video with live stream URL\n", "content": "# coding: utf-8\nfrom __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..compat import (\n    compat_parse_qs,\n    compat_str,\n    compat_urllib_parse_urlparse,\n)\nfrom ..utils import (\n    urljoin,\n    int_or_none,\n    parse_codecs,\n    try_get,\n)\n\n\ndef _raw_id(src_url):\n    return compat_urllib_parse_urlparse(src_url).path.split('/')[-1]\n\n\nclass SeznamZpravyIE(InfoExtractor):\n    _VALID_URL = r'https?://(?:www\\.)?seznamzpravy\\.cz/iframe/player\\?.*\\bsrc='\n    _TESTS = [{\n        'url': 'https://www.seznamzpravy.cz/iframe/player?duration=241&serviceSlug=zpravy&src=https%3A%2F%2Fv39-a.sdn.szn.cz%2Fv_39%2Fvmd%2F5999c902ea707c67d8e267a9%3Ffl%3Dmdk%2C432f65a0%7C&itemType=video&autoPlay=false&title=Sv%C4%9Bt%20bez%20obalu%3A%20%C4%8Ce%C5%A1t%C3%AD%20voj%C3%A1ci%20na%20mis%C3%ADch%20(kr%C3%A1tk%C3%A1%20verze)&series=Sv%C4%9Bt%20bez%20obalu&serviceName=Seznam%20Zpr%C3%A1vy&poster=%2F%2Fd39-a.sdn.szn.cz%2Fd_39%2Fc_img_F_I%2FR5puJ.jpeg%3Ffl%3Dcro%2C0%2C0%2C1920%2C1080%7Cres%2C1200%2C%2C1%7Cjpg%2C80%2C%2C1&width=1920&height=1080&cutFrom=0&cutTo=0&splVersion=VOD&contentId=170889&contextId=35990&showAdvert=true&collocation=&autoplayPossible=true&embed=&isVideoTooShortForPreroll=false&isVideoTooLongForPostroll=true&videoCommentOpKey=&videoCommentId=&version=4.0.76&dotService=zpravy&gemiusPrismIdentifier=bVc1ZIb_Qax4W2v5xOPGpMeCP31kFfrTzj0SqPTLh_b.Z7&zoneIdPreroll=seznam.pack.videospot&skipOffsetPreroll=5&sectionPrefixPreroll=%2Fzpravy',\n        'info_dict': {\n            'id': '170889',\n            'ext': 'mp4',\n            'title': 'Sv\u011bt bez obalu: \u010ce\u0161t\u00ed voj\u00e1ci na mis\u00edch (kr\u00e1tk\u00e1 verze)',\n            'thumbnail': r're:^https?://.*\\.jpe?g',\n            'duration': 241,\n            'series': 'Sv\u011bt bez obalu',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        # with Location key\n        'url': 'https://www.seznamzpravy.cz/iframe/player?duration=null&serviceSlug=zpravy&src=https%3A%2F%2Flive-a.sdn.szn.cz%2Fv_39%2F59e468fe454f8472a96af9fa%3Ffl%3Dmdk%2C5c1e2840%7C&itemType=livevod&autoPlay=false&title=P%C5%99edseda%20KDU-%C4%8CSL%20Pavel%20B%C4%9Blobr%C3%A1dek%20ve%20volebn%C3%AD%20V%C3%BDzv%C4%9B%20Seznamu&series=V%C3%BDzva&serviceName=Seznam%20Zpr%C3%A1vy&poster=%2F%2Fd39-a.sdn.szn.cz%2Fd_39%2Fc_img_G_J%2FjTBCs.jpeg%3Ffl%3Dcro%2C0%2C0%2C1280%2C720%7Cres%2C1200%2C%2C1%7Cjpg%2C80%2C%2C1&width=16&height=9&cutFrom=0&cutTo=0&splVersion=VOD&contentId=185688&contextId=38489&showAdvert=true&collocation=&hideFullScreen=false&hideSubtitles=false&embed=&isVideoTooShortForPreroll=false&isVideoTooShortForPreroll2=false&isVideoTooLongForPostroll=false&fakePostrollZoneID=seznam.clanky.zpravy.preroll&fakePrerollZoneID=seznam.clanky.zpravy.preroll&videoCommentId=&trim=default_16x9&noPrerollVideoLength=30&noPreroll2VideoLength=undefined&noMidrollVideoLength=0&noPostrollVideoLength=999999&autoplayPossible=true&version=5.0.41&dotService=zpravy&gemiusPrismIdentifier=zD3g7byfW5ekpXmxTVLaq5Srjw5i4hsYo0HY1aBwIe..27&zoneIdPreroll=seznam.pack.videospot&skipOffsetPreroll=5&sectionPrefixPreroll=%2Fzpravy%2Fvyzva&zoneIdPostroll=seznam.pack.videospot&skipOffsetPostroll=5&sectionPrefixPostroll=%2Fzpravy%2Fvyzva&regression=false',\n        'info_dict': {\n            'id': '185688',\n            'ext': 'mp4',\n            'title': 'P\u0159edseda KDU-\u010cSL Pavel B\u011blobr\u00e1dek ve volebn\u00ed V\u00fdzv\u011b Seznamu',\n            'thumbnail': r're:^https?://.*\\.jpe?g',\n            'series': 'V\u00fdzva',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }]\n\n    @staticmethod\n    def _extract_urls(webpage):\n        return [\n            mobj.group('url') for mobj in re.finditer(\n                r'<iframe\\b[^>]+\\bsrc=([\"\\'])(?P<url>(?:https?:)?//(?:www\\.)?seznamzpravy\\.cz/iframe/player\\?.*?)\\1',\n                webpage)]\n\n    def _extract_sdn_formats(self, sdn_url, video_id):\n        sdn_data = self._download_json(sdn_url, video_id)\n\n        if sdn_data.get('Location'):\n            sdn_url = sdn_data['Location']\n            sdn_data = self._download_json(sdn_url, video_id)\n\n        formats = []\n        mp4_formats = try_get(sdn_data, lambda x: x['data']['mp4'], dict) or {}\n        for format_id, format_data in mp4_formats.items():\n            relative_url = format_data.get('url')\n            if not relative_url:\n                continue\n\n            try:\n                width, height = format_data.get('resolution')\n            except (TypeError, ValueError):\n                width, height = None, None\n\n            f = {\n                'url': urljoin(sdn_url, relative_url),\n                'format_id': 'http-%s' % format_id,\n                'tbr': int_or_none(format_data.get('bandwidth'), scale=1000),\n                'width': int_or_none(width),\n                'height': int_or_none(height),\n            }\n            f.update(parse_codecs(format_data.get('codec')))\n            formats.append(f)\n\n        pls = sdn_data.get('pls', {})\n\n        def get_url(format_id):\n            return try_get(pls, lambda x: x[format_id]['url'], compat_str)\n\n        dash_rel_url = get_url('dash')\n        if dash_rel_url:\n            formats.extend(self._extract_mpd_formats(\n                urljoin(sdn_url, dash_rel_url), video_id, mpd_id='dash',\n                fatal=False))\n\n        hls_rel_url = get_url('hls')\n        if hls_rel_url:\n            formats.extend(self._extract_m3u8_formats(\n                urljoin(sdn_url, hls_rel_url), video_id, ext='mp4',\n                m3u8_id='hls', fatal=False))\n\n        self._sort_formats(formats)\n        return formats\n\n    def _real_extract(self, url):\n        params = compat_parse_qs(compat_urllib_parse_urlparse(url).query)\n\n        src = params['src'][0]\n        title = params['title'][0]\n        video_id = params.get('contentId', [_raw_id(src)])[0]\n        formats = self._extract_sdn_formats(src + 'spl2,2,VOD', video_id)\n\n        duration = int_or_none(params.get('duration', [None])[0])\n        series = params.get('series', [None])[0]\n        thumbnail = params.get('poster', [None])[0]\n\n        return {\n            'id': video_id,\n            'title': title,\n            'thumbnail': thumbnail,\n            'duration': duration,\n            'series': series,\n            'formats': formats,\n        }\n\n\nclass SeznamZpravyArticleIE(InfoExtractor):\n    _VALID_URL = r'https?://(?:www\\.)?(?:seznam\\.cz/zpravy|seznamzpravy\\.cz)/clanek/(?:[^/?#&]+)-(?P<id>\\d+)'\n    _API_URL = 'https://apizpravy.seznam.cz/'\n\n    _TESTS = [{\n        # two videos on one page, with SDN URL\n        'url': 'https://www.seznamzpravy.cz/clanek/jejich-svet-na-nas-utoci-je-lepsi-branit-se-na-jejich-pisecku-rika-reziser-a-major-v-zaloze-marhoul-35990',\n        'info_dict': {\n            'id': '35990',\n            'title': 'md5:6011c877a36905f28f271fcd8dcdb0f2',\n            'description': 'md5:933f7b06fa337a814ba199d3596d27ba',\n        },\n        'playlist_count': 2,\n    }, {\n        # video with live stream URL\n        'url': 'https://www.seznam.cz/zpravy/clanek/znovu-do-vlady-s-ano-pavel-belobradek-ve-volebnim-specialu-seznamu-38489',\n        'info_dict': {\n            'id': '38489',\n            'title': 'md5:8fa1afdc36fd378cf0eba2b74c5aca60',\n            'description': 'md5:428e7926a1a81986ec7eb23078004fb4',\n        },\n        'playlist_count': 1,\n    }]\n\n    def _real_extract(self, url):\n        article_id = self._match_id(url)\n\n        webpage = self._download_webpage(url, article_id)\n\n        info = self._search_json_ld(webpage, article_id, default={})\n\n        title = info.get('title') or self._og_search_title(webpage, fatal=False)\n        description = info.get('description') or self._og_search_description(webpage)\n\n        return self.playlist_result([\n            self.url_result(url, ie=SeznamZpravyIE.ie_key())\n            for url in SeznamZpravyIE._extract_urls(webpage)],\n            article_id, title, description)\n", "description": "Command-line program to download videos from YouTube.com and other video sites", "file_name": "seznamzpravy.py", "language": "Python", "project_name": "youtube-dl", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/rg3_youtube-dl/rg3-youtube-dl-6202f08/youtube_dl/extractor/seznamzpravy.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:18:39Z", "url": "https://github.com/rg3/youtube-dl", "wiki": false}