{"author": "ansible", "code": "import json\nimport sys\n\nfrom ansible.module_utils.basic import AnsibleModule\n\n\ndef main():\n    if \"--interactive\" in sys.argv:\n        import ansible.module_utils.basic\n        ansible.module_utils.basic._ANSIBLE_ARGS = json.dumps(dict(\n            ANSIBLE_MODULE_ARGS=dict(\n                fail_mode=\"graceful\"\n            )\n        ))\n\n    module = AnsibleModule(\n        argument_spec=dict(\n            fail_mode=dict(type='list', default=['success'])\n        )\n    )\n\n    result = dict(changed=True)\n\n    fail_mode = module.params['fail_mode']\n\n    try:\n        if 'leading_junk' in fail_mode:\n            print(\"leading junk before module output\")\n\n        if 'graceful' in fail_mode:\n            module.fail_json(msg=\"failed gracefully\")\n\n        if 'exception' in fail_mode:\n            raise Exception('failing via exception')\n\n        module.exit_json(**result)\n\n    finally:\n        if 'trailing_junk' in fail_mode:\n            print(\"trailing junk after module output\")\n\nmain()\n", "comments": "", "content": "import json\nimport sys\n\nfrom ansible.module_utils.basic import AnsibleModule\n\n\ndef main():\n    if \"--interactive\" in sys.argv:\n        import ansible.module_utils.basic\n        ansible.module_utils.basic._ANSIBLE_ARGS = json.dumps(dict(\n            ANSIBLE_MODULE_ARGS=dict(\n                fail_mode=\"graceful\"\n            )\n        ))\n\n    module = AnsibleModule(\n        argument_spec=dict(\n            fail_mode=dict(type='list', default=['success'])\n        )\n    )\n\n    result = dict(changed=True)\n\n    fail_mode = module.params['fail_mode']\n\n    try:\n        if 'leading_junk' in fail_mode:\n            print(\"leading junk before module output\")\n\n        if 'graceful' in fail_mode:\n            module.fail_json(msg=\"failed gracefully\")\n\n        if 'exception' in fail_mode:\n            raise Exception('failing via exception')\n\n        module.exit_json(**result)\n\n    finally:\n        if 'trailing_junk' in fail_mode:\n            print(\"trailing junk after module output\")\n\nmain()\n", "description": "Ansible is a radically simple IT automation platform that makes your applications and systems easier to deploy. Avoid writing scripts or custom code to deploy and update your applications\u2014 automate in a language that approaches plain English, using SSH, with no agents to install on remote systems.", "file_name": "async_test.py", "id": "bd86b887ff4fec0968e8aa068080c4f6", "language": "Python", "project_name": "ansible", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/ansible-ansible/ansible-ansible-d30554b/test/integration/targets/async/library/async_test.py", "save_time": "", "source": "", "update_at": "2018-03-18T14:08:28Z", "url": "https://github.com/ansible/ansible", "wiki": false}