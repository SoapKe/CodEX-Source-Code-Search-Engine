{"author": "getsentry", "code": "from __future__ import absolute_import\n\nfrom mock import patch\n\nfrom datetime import timedelta\n\nfrom sentry.models import Option\nfrom sentry.options import default_store, default_manager\nfrom sentry.tasks.options import sync_options\nfrom sentry.testutils import TestCase\n\n\nclass SyncOptionsTest(TestCase):\n    def test_task_persistent_name(self):\n        assert sync_options.name == 'sentry.tasks.options.sync_options'\n\n    @patch.object(default_store, 'set_cache')\n    def test_simple(self, mock_set_cache):\n        default_manager.register('foo')\n        option = Option.objects.create(\n            key='foo',\n            value='bar',\n        )\n        sync_options(cutoff=60)\n\n        assert mock_set_cache.called\n        mock_set_cache.reset_mock()\n\n        option.update(last_updated=option.last_updated - timedelta(days=1))\n\n        sync_options(cutoff=60)\n\n        assert not mock_set_cache.called\n", "comments": "", "content": "from __future__ import absolute_import\n\nfrom mock import patch\n\nfrom datetime import timedelta\n\nfrom sentry.models import Option\nfrom sentry.options import default_store, default_manager\nfrom sentry.tasks.options import sync_options\nfrom sentry.testutils import TestCase\n\n\nclass SyncOptionsTest(TestCase):\n    def test_task_persistent_name(self):\n        assert sync_options.name == 'sentry.tasks.options.sync_options'\n\n    @patch.object(default_store, 'set_cache')\n    def test_simple(self, mock_set_cache):\n        default_manager.register('foo')\n        option = Option.objects.create(\n            key='foo',\n            value='bar',\n        )\n        sync_options(cutoff=60)\n\n        assert mock_set_cache.called\n        mock_set_cache.reset_mock()\n\n        option.update(last_updated=option.last_updated - timedelta(days=1))\n\n        sync_options(cutoff=60)\n\n        assert not mock_set_cache.called\n", "description": "Sentry is a cross-platform crash reporting and aggregation platform.", "file_name": "test_options.py", "id": "01029e0e7ed6e23fd711262258d47b65", "language": "Python", "project_name": "sentry", "quality": "", "save_path": "/home/ubuntu/test_files/clean/network_test/getsentry-sentry/getsentry-sentry-6a9c7e2/tests/sentry/tasks/test_options.py", "save_time": "", "source": "", "update_at": "2018-03-14T01:23:24Z", "url": "https://github.com/getsentry/sentry", "wiki": false}