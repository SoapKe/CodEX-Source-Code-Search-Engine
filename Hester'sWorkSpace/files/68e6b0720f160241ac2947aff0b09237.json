{"author": "getsentry", "code": "from __future__ import absolute_import\n\nfrom sentry.utils.zip import is_unsafe_path, find_common_prefix\n\n\ndef test_is_unsafe_path():\n    assert is_unsafe_path('/foo.txt')\n    assert is_unsafe_path('../foo.txt')\n    assert is_unsafe_path('aha/../foo.txt')\n    assert not is_unsafe_path('foo.txt')\n    assert not is_unsafe_path('foo/bar.txt')\n\n\ndef test_find_common_prefix():\n    assert find_common_prefix(['foo/bar', '.crap', 'foo/bar/baz']) == 'foo/'\n    assert find_common_prefix(['foo/bar', '.crap', 'x/foo/bar/baz']) == ''\n    assert find_common_prefix(['foo/bar', 'foo']) == 'foo/'\n    assert find_common_prefix(['foo/bar', 'bar']) == ''\n", "comments": "", "content": "from __future__ import absolute_import\n\nfrom sentry.utils.zip import is_unsafe_path, find_common_prefix\n\n\ndef test_is_unsafe_path():\n    assert is_unsafe_path('/foo.txt')\n    assert is_unsafe_path('../foo.txt')\n    assert is_unsafe_path('aha/../foo.txt')\n    assert not is_unsafe_path('foo.txt')\n    assert not is_unsafe_path('foo/bar.txt')\n\n\ndef test_find_common_prefix():\n    assert find_common_prefix(['foo/bar', '.crap', 'foo/bar/baz']) == 'foo/'\n    assert find_common_prefix(['foo/bar', '.crap', 'x/foo/bar/baz']) == ''\n    assert find_common_prefix(['foo/bar', 'foo']) == 'foo/'\n    assert find_common_prefix(['foo/bar', 'bar']) == ''\n", "description": "Sentry is a cross-platform crash reporting and aggregation platform.", "file_name": "test_zip.py", "id": "68e6b0720f160241ac2947aff0b09237", "language": "Python", "project_name": "sentry", "quality": "", "save_path": "/home/ubuntu/test_files/clean/network_test/getsentry-sentry/getsentry-sentry-6a9c7e2/tests/sentry/utils/test_zip.py", "save_time": "", "source": "", "update_at": "2018-03-14T01:23:24Z", "url": "https://github.com/getsentry/sentry", "wiki": false}