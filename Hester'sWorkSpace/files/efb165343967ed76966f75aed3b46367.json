{"author": "getredash", "code": "from playhouse.migrate import PostgresqlMigrator, migrate\n\nfrom redash.models import db\nfrom redash import models\n\nif __name__ == '__main__':\n    db.connect_db()\n    migrator = PostgresqlMigrator(db.database)\n\n    with db.database.transaction():\n        migrate(\n            migrator.add_column('queries', 'updated_at', models.Query.updated_at),\n            migrator.add_column('dashboards', 'updated_at', models.Dashboard.updated_at),\n            migrator.add_column('widgets', 'updated_at', models.Widget.updated_at),\n            migrator.add_column('users', 'created_at', models.User.created_at),\n            migrator.add_column('users', 'updated_at', models.User.updated_at),\n            migrator.add_column('visualizations', 'created_at', models.Visualization.created_at),\n            migrator.add_column('visualizations', 'updated_at', models.Visualization.updated_at)\n        )\n\n        db.database.execute_sql(\"UPDATE queries SET updated_at = created_at;\")\n        db.database.execute_sql(\"UPDATE dashboards SET updated_at = created_at;\")\n        db.database.execute_sql(\"UPDATE widgets SET updated_at = created_at;\")\n\n    db.close_db(None)\n", "comments": "", "content": "from playhouse.migrate import PostgresqlMigrator, migrate\n\nfrom redash.models import db\nfrom redash import models\n\nif __name__ == '__main__':\n    db.connect_db()\n    migrator = PostgresqlMigrator(db.database)\n\n    with db.database.transaction():\n        migrate(\n            migrator.add_column('queries', 'updated_at', models.Query.updated_at),\n            migrator.add_column('dashboards', 'updated_at', models.Dashboard.updated_at),\n            migrator.add_column('widgets', 'updated_at', models.Widget.updated_at),\n            migrator.add_column('users', 'created_at', models.User.created_at),\n            migrator.add_column('users', 'updated_at', models.User.updated_at),\n            migrator.add_column('visualizations', 'created_at', models.Visualization.created_at),\n            migrator.add_column('visualizations', 'updated_at', models.Visualization.updated_at)\n        )\n\n        db.database.execute_sql(\"UPDATE queries SET updated_at = created_at;\")\n        db.database.execute_sql(\"UPDATE dashboards SET updated_at = created_at;\")\n        db.database.execute_sql(\"UPDATE widgets SET updated_at = created_at;\")\n\n    db.close_db(None)\n", "description": "Make Your Company Data Driven. Connect to any data source, easily visualize and share your data.", "file_name": "0005_add_updated_at.py", "id": "efb165343967ed76966f75aed3b46367", "language": "Python", "project_name": "redash", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/getredash-redash/getredash-redash-0410d83/old_migrations/0005_add_updated_at.py", "save_time": "", "source": "", "update_at": "2018-03-18T12:54:55Z", "url": "https://github.com/getredash/redash", "wiki": false}