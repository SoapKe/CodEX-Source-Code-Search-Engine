{"author": "odoo", "code": "# -*- coding: utf-8 -*-\n\n\nimport json\n\nfrom odoo import models\nfrom odoo.http import request\n\nimport odoo\n\n\nclass Http(models.AbstractModel):\n    _inherit = 'ir.http'\n\n    def webclient_rendering_context(self):\n        return {\n            'menu_data': request.env['ir.ui.menu'].load_menus(request.debug),\n            'session_info': json.dumps(self.session_info()),\n        }\n\n    def session_info(self):\n        user = request.env.user\n        display_switch_company_menu = user.has_group('base.group_multi_company') and len(user.company_ids) > 1\n        version_info = odoo.service.common.exp_version()\n        return {\n            \"session_id\": request.session.sid,\n            \"uid\": request.session.uid,\n            \"is_system\": request.env.user._is_system(),\n            \"is_superuser\": request.env.user._is_superuser(),\n            \"user_context\": request.session.get_context() if request.session.uid else {},\n            \"db\": request.session.db,\n            \"server_version\": version_info.get('server_version'),\n            \"server_version_info\": version_info.get('server_version_info'),\n            \"name\": user.name,\n            \"username\": user.login,\n            \"company_id\": request.env.user.company_id.id if request.session.uid else None,\n            \"partner_id\": request.env.user.partner_id.id if request.session.uid and request.env.user.partner_id else None,\n            \"user_companies\": {'current_company': (user.company_id.id, user.company_id.name), 'allowed_companies': [(comp.id, comp.name) for comp in user.company_ids]} if display_switch_company_menu else False,\n            \"currencies\": self.get_currencies(),\n            \"web.base.url\": self.env['ir.config_parameter'].sudo().get_param('web.base.url', default=''),\n        }\n\n    def get_currencies(self):\n        Currency = request.env['res.currency']\n        currencies = Currency.search([]).read(['symbol', 'position', 'decimal_places'])\n        return { c['id']: {'symbol': c['symbol'], 'position': c['position'], 'digits': [69,c['decimal_places']]} for c in currencies} \n", "comments": "      coding  utf 8        part odoo  see license file full copyright licensing details  ", "content": "# -*- coding: utf-8 -*-\n# Part of Odoo. See LICENSE file for full copyright and licensing details.\n\nimport json\n\nfrom odoo import models\nfrom odoo.http import request\n\nimport odoo\n\n\nclass Http(models.AbstractModel):\n    _inherit = 'ir.http'\n\n    def webclient_rendering_context(self):\n        return {\n            'menu_data': request.env['ir.ui.menu'].load_menus(request.debug),\n            'session_info': json.dumps(self.session_info()),\n        }\n\n    def session_info(self):\n        user = request.env.user\n        display_switch_company_menu = user.has_group('base.group_multi_company') and len(user.company_ids) > 1\n        version_info = odoo.service.common.exp_version()\n        return {\n            \"session_id\": request.session.sid,\n            \"uid\": request.session.uid,\n            \"is_system\": request.env.user._is_system(),\n            \"is_superuser\": request.env.user._is_superuser(),\n            \"user_context\": request.session.get_context() if request.session.uid else {},\n            \"db\": request.session.db,\n            \"server_version\": version_info.get('server_version'),\n            \"server_version_info\": version_info.get('server_version_info'),\n            \"name\": user.name,\n            \"username\": user.login,\n            \"company_id\": request.env.user.company_id.id if request.session.uid else None,\n            \"partner_id\": request.env.user.partner_id.id if request.session.uid and request.env.user.partner_id else None,\n            \"user_companies\": {'current_company': (user.company_id.id, user.company_id.name), 'allowed_companies': [(comp.id, comp.name) for comp in user.company_ids]} if display_switch_company_menu else False,\n            \"currencies\": self.get_currencies(),\n            \"web.base.url\": self.env['ir.config_parameter'].sudo().get_param('web.base.url', default=''),\n        }\n\n    def get_currencies(self):\n        Currency = request.env['res.currency']\n        currencies = Currency.search([]).read(['symbol', 'position', 'decimal_places'])\n        return { c['id']: {'symbol': c['symbol'], 'position': c['position'], 'digits': [69,c['decimal_places']]} for c in currencies} \n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "ir_http.py", "id": "59356cb1f20e9d6e9a92b0117600efac", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/web/models/ir_http.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}