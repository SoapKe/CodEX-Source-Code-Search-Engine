{"author": "nvbn", "code": "\nfrom subprocess import call\nimport os\nimport re\n\n\nversion = None\n\n\ndef get_new_setup_py_lines():\n    global version\n    with open('setup.py', 'r') as sf:\n        current_setup = sf.readlines()\n    for line in current_setup:\n        if line.startswith('VERSION = '):\n            major, minor = re.findall(r\"VERSION = '(\\d+)\\.(\\d+)'\", line)[0]\n            version = \"{}.{}\".format(major, int(minor) + 1)\n            yield \"VERSION = '{}'\\n\".format(version)\n        else:\n            yield line\n\n\nlines = list(get_new_setup_py_lines())\nwith open('setup.py', 'w') as sf:\n    sf.writelines(lines)\n\ncall('git pull', shell=True)\ncall('git commit -am \"Bump to {}\"'.format(version), shell=True)\ncall('git tag {}'.format(version), shell=True)\ncall('git push', shell=True)\ncall('git push --tags', shell=True)\n\nenv = os.environ\nenv['CONVERT_README'] = 'true'\ncall('python setup.py sdist bdist_wheel upload', shell=True, env=env)\n", "comments": "#!/usr/bin/env python\n", "content": "#!/usr/bin/env python\nfrom subprocess import call\nimport os\nimport re\n\n\nversion = None\n\n\ndef get_new_setup_py_lines():\n    global version\n    with open('setup.py', 'r') as sf:\n        current_setup = sf.readlines()\n    for line in current_setup:\n        if line.startswith('VERSION = '):\n            major, minor = re.findall(r\"VERSION = '(\\d+)\\.(\\d+)'\", line)[0]\n            version = \"{}.{}\".format(major, int(minor) + 1)\n            yield \"VERSION = '{}'\\n\".format(version)\n        else:\n            yield line\n\n\nlines = list(get_new_setup_py_lines())\nwith open('setup.py', 'w') as sf:\n    sf.writelines(lines)\n\ncall('git pull', shell=True)\ncall('git commit -am \"Bump to {}\"'.format(version), shell=True)\ncall('git tag {}'.format(version), shell=True)\ncall('git push', shell=True)\ncall('git push --tags', shell=True)\n\nenv = os.environ\nenv['CONVERT_README'] = 'true'\ncall('python setup.py sdist bdist_wheel upload', shell=True, env=env)\n", "description": "Magnificent app which corrects your previous console command.", "file_name": "release.py", "language": "Python", "project_name": "thefuck", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/nvbn_thefuck/nvbn-thefuck-284d49d/release.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:34:29Z", "url": "https://github.com/nvbn/thefuck", "wiki": true}