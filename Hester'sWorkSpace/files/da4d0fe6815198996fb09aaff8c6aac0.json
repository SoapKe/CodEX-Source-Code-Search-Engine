{"author": "getredash", "code": "from redash.models import db\nimport peewee\nfrom playhouse.migrate import PostgresqlMigrator, migrate\n\nif __name__ == '__main__':\n    migrator = PostgresqlMigrator(db.database)\n\n    with db.database.transaction():\n        # Change the uniqueness constraint on data source name to be (org, name):\n        \n        db.database.execute_sql('ALTER TABLE data_sources DROP CONSTRAINT IF EXISTS unique_name')\n        \n        db.database.execute_sql('DROP INDEX IF EXISTS data_sources_name')\n\n        migrate(\n            migrator.add_index('data_sources', ('org_id', 'name'), unique=True)\n        )\n\n    db.close_db(None)\n", "comments": "  change uniqueness constraint data source name (org  name)     in cases constraint     in others index  ", "content": "from redash.models import db\nimport peewee\nfrom playhouse.migrate import PostgresqlMigrator, migrate\n\nif __name__ == '__main__':\n    migrator = PostgresqlMigrator(db.database)\n\n    with db.database.transaction():\n        # Change the uniqueness constraint on data source name to be (org, name):\n        # In some cases it's a constraint:\n        db.database.execute_sql('ALTER TABLE data_sources DROP CONSTRAINT IF EXISTS unique_name')\n        # In others only an index:\n        db.database.execute_sql('DROP INDEX IF EXISTS data_sources_name')\n\n        migrate(\n            migrator.add_index('data_sources', ('org_id', 'name'), unique=True)\n        )\n\n    db.close_db(None)\n", "description": "Make Your Company Data Driven. Connect to any data source, easily visualize and share your data.", "file_name": "0020_change_ds_name_to_non_uniqe.py", "id": "da4d0fe6815198996fb09aaff8c6aac0", "language": "Python", "project_name": "redash", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/getredash-redash/getredash-redash-0410d83/old_migrations/0020_change_ds_name_to_non_uniqe.py", "save_time": "", "source": "", "update_at": "2018-03-18T12:54:55Z", "url": "https://github.com/getredash/redash", "wiki": false}