{"author": "ansible", "code": "\n -*- coding: utf-8 -*-\n\n Copyright (c) 2016 Red Hat, Inc.\n\n This file is part of Ansible\n\n Ansible is free software: you can redistribute it and/or modify\n it under the terms of the GNU General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n Ansible is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU General Public License for more details.\n\n You should have received a copy of the GNU General Public License\n along with Ansible.  If not, see <http://www.gnu.org/licenses/>.\n\n\nANSIBLE_METADATA = {'metadata_version': '1.1',\n                    'status': ['preview'],\n                    'supported_by': 'community'}\n\n\nDOCUMENTATION = '''\n---\nmodule: ovirt_external_provider_facts\nshort_description: Retrieve facts about one or more oVirt/RHV external providers\nauthor: \"Ondra Machacek (@machacekondra)\"\nversion_added: \"2.3\"\ndescription:\n    - \"Retrieve facts about one or more oVirt/RHV external providers.\"\nnotes:\n    - \"This module creates a new top-level C(ovirt_external_providers) fact, which\n       contains a list of external_providers.\"\noptions:\n    type:\n        description:\n            - \"Type of the external provider.\"\n        choices: ['os_image', 'os_network', 'os_volume', 'foreman']\n        required: true\n    name:\n        description:\n            - \"Name of the external provider, can be used as glob expression.\"\nextends_documentation_fragment: ovirt_facts\n'''\n\nEXAMPLES = '''\n Examples don't contain auth parameter for simplicity,\n look at ovirt_auth module to see how to reuse authentication:\n\n Gather facts about all image external providers named C<glance>:\n- ovirt_external_provider_facts:\n    type: os_image\n    name: glance\n- debug:\n    var: ovirt_external_providers\n'''\n\nRETURN = '''\nexternal_host_providers:\n    description: \"List of dictionaries of all the external_host_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/types/external_host_provider.\"\n    returned: \"On success and if parameter 'type: foreman' is used.\"\n    type: list\nopenstack_image_providers:\n    description: \"List of dictionaries of all the openstack_image_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/types/openstack_image_provider.\"\n    returned: \"On success and if parameter 'type: os_image' is used.\"\n    type: list\nopenstack_volume_providers:\n    description: \"List of dictionaries of all the openstack_volume_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/types/openstack_volume_provider.\"\n    returned: \"On success and if parameter 'type: os_volume' is used.\"\n    type: list\nopenstack_network_providers:\n    description: \"List of dictionaries of all the openstack_network_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/types/openstack_network_provider.\"\n    returned: \"On success and if parameter 'type: os_network' is used.\"\n    type: list\n'''\n\nimport fnmatch\nimport traceback\n\nfrom ansible.module_utils.basic import AnsibleModule\nfrom ansible.module_utils.ovirt import (\n    check_sdk,\n    create_connection,\n    get_dict_of_struct,\n    ovirt_facts_full_argument_spec,\n)\n\n\ndef _external_provider_service(provider_type, system_service):\n    if provider_type == 'os_image':\n        return system_service.openstack_image_providers_service()\n    elif provider_type == 'os_network':\n        return system_service.openstack_network_providers_service()\n    elif provider_type == 'os_volume':\n        return system_service.openstack_volume_providers_service()\n    elif provider_type == 'foreman':\n        return system_service.external_host_providers_service()\n\n\ndef main():\n    argument_spec = ovirt_facts_full_argument_spec(\n        name=dict(default=None, required=False),\n        type=dict(\n            default=None,\n            required=True,\n            choices=[\n                'os_image', 'os_network', 'os_volume', 'foreman',\n            ],\n            aliases=['provider'],\n        ),\n    )\n    module = AnsibleModule(argument_spec)\n\n    if module._name == 'ovirt_external_providers_facts':\n        module.deprecate(\"The 'ovirt_external_providers_facts' module is being renamed 'ovirt_external_provider_facts'\", version=2.8)\n\n    check_sdk(module)\n\n    try:\n        auth = module.params.pop('auth')\n        connection = create_connection(auth)\n        external_providers_service = _external_provider_service(\n            provider_type=module.params.pop('type'),\n            system_service=connection.system_service(),\n        )\n        if module.params['name']:\n            external_providers = [\n                e for e in external_providers_service.list()\n                if fnmatch.fnmatch(e.name, module.params['name'])\n            ]\n        else:\n            external_providers = external_providers_service.list()\n\n        module.exit_json(\n            changed=False,\n            ansible_facts=dict(\n                ovirt_external_providers=[\n                    get_dict_of_struct(\n                        struct=c,\n                        connection=connection,\n                        fetch_nested=module.params.get('fetch_nested'),\n                        attributes=module.params.get('nested_attributes'),\n                    ) for c in external_providers\n                ],\n            ),\n        )\n    except Exception as e:\n        module.fail_json(msg=str(e), exception=traceback.format_exc())\n    finally:\n        connection.close(logout=auth.get('token') is None)\n\n\nif __name__ == '__main__':\n    main()\n", "comments": "        module  ovirt external provider facts short description  retrieve facts one ovirt rhv external providers author   ondra machacek ( machacekondra)  version added   2 3  description         retrieve facts one ovirt rhv external providers   notes         this module creates new top level c(ovirt external providers) fact         contains list external providers   options      type          description                 type external provider           choices    os image    os network    os volume    foreman           required  true     name          description                 name external provider  used glob expression   extends documentation fragment  ovirt facts      examples         examples contain auth parameter simplicity    look ovirt auth module see reuse authentication     gather facts image external providers named c glance     ovirt external provider facts      type  os image     name  glance   debug      var  ovirt external providers      return       external host providers      description   list dictionaries external host provider attributes  external provider attributes found ovirt rhv instance                   following url  http   ovirt github io ovirt engine api model master  types external host provider       returned   on success parameter  type  foreman  used       type  list openstack image providers      description   list dictionaries openstack image provider attributes  external provider attributes found ovirt rhv instance                   following url  http   ovirt github io ovirt engine api model master  types openstack image provider       returned   on success parameter  type  os image  used       type  list openstack volume providers      description   list dictionaries openstack volume provider attributes  external provider attributes found ovirt rhv instance                   following url  http   ovirt github io ovirt engine api model master  types openstack volume provider       returned   on success parameter  type  os volume  used       type  list openstack network providers      description   list dictionaries openstack network provider attributes  external provider attributes found ovirt rhv instance                   following url  http   ovirt github io ovirt engine api model master  types openstack network provider       returned   on success parameter  type  os network  used       type  list         usr bin python        coding  utf 8           copyright (c) 2016 red hat  inc        this file part ansible       ansible free software  redistribute modify    terms gnu general public license published    free software foundation  either version 3 license     (at option) later version        ansible distributed hope useful     without any warranty  without even implied warranty    merchantability fitness for a particular purpose   see    gnu general public license details        you received copy gnu general public license    along ansible   if  see  http   www gnu org licenses          examples contain auth parameter simplicity     look ovirt auth module see reuse authentication     gather facts image external providers named c glance     types external host provider     types openstack image provider     types openstack volume provider     types openstack network provider   ", "content": "#!/usr/bin/python\n# -*- coding: utf-8 -*-\n#\n# Copyright (c) 2016 Red Hat, Inc.\n#\n# This file is part of Ansible\n#\n# Ansible is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Ansible is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Ansible.  If not, see <http://www.gnu.org/licenses/>.\n#\n\nANSIBLE_METADATA = {'metadata_version': '1.1',\n                    'status': ['preview'],\n                    'supported_by': 'community'}\n\n\nDOCUMENTATION = '''\n---\nmodule: ovirt_external_provider_facts\nshort_description: Retrieve facts about one or more oVirt/RHV external providers\nauthor: \"Ondra Machacek (@machacekondra)\"\nversion_added: \"2.3\"\ndescription:\n    - \"Retrieve facts about one or more oVirt/RHV external providers.\"\nnotes:\n    - \"This module creates a new top-level C(ovirt_external_providers) fact, which\n       contains a list of external_providers.\"\noptions:\n    type:\n        description:\n            - \"Type of the external provider.\"\n        choices: ['os_image', 'os_network', 'os_volume', 'foreman']\n        required: true\n    name:\n        description:\n            - \"Name of the external provider, can be used as glob expression.\"\nextends_documentation_fragment: ovirt_facts\n'''\n\nEXAMPLES = '''\n# Examples don't contain auth parameter for simplicity,\n# look at ovirt_auth module to see how to reuse authentication:\n\n# Gather facts about all image external providers named C<glance>:\n- ovirt_external_provider_facts:\n    type: os_image\n    name: glance\n- debug:\n    var: ovirt_external_providers\n'''\n\nRETURN = '''\nexternal_host_providers:\n    description: \"List of dictionaries of all the external_host_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/#types/external_host_provider.\"\n    returned: \"On success and if parameter 'type: foreman' is used.\"\n    type: list\nopenstack_image_providers:\n    description: \"List of dictionaries of all the openstack_image_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/#types/openstack_image_provider.\"\n    returned: \"On success and if parameter 'type: os_image' is used.\"\n    type: list\nopenstack_volume_providers:\n    description: \"List of dictionaries of all the openstack_volume_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/#types/openstack_volume_provider.\"\n    returned: \"On success and if parameter 'type: os_volume' is used.\"\n    type: list\nopenstack_network_providers:\n    description: \"List of dictionaries of all the openstack_network_provider attributes. External provider attributes can be found on your oVirt/RHV instance\n                  at following url: http://ovirt.github.io/ovirt-engine-api-model/master/#types/openstack_network_provider.\"\n    returned: \"On success and if parameter 'type: os_network' is used.\"\n    type: list\n'''\n\nimport fnmatch\nimport traceback\n\nfrom ansible.module_utils.basic import AnsibleModule\nfrom ansible.module_utils.ovirt import (\n    check_sdk,\n    create_connection,\n    get_dict_of_struct,\n    ovirt_facts_full_argument_spec,\n)\n\n\ndef _external_provider_service(provider_type, system_service):\n    if provider_type == 'os_image':\n        return system_service.openstack_image_providers_service()\n    elif provider_type == 'os_network':\n        return system_service.openstack_network_providers_service()\n    elif provider_type == 'os_volume':\n        return system_service.openstack_volume_providers_service()\n    elif provider_type == 'foreman':\n        return system_service.external_host_providers_service()\n\n\ndef main():\n    argument_spec = ovirt_facts_full_argument_spec(\n        name=dict(default=None, required=False),\n        type=dict(\n            default=None,\n            required=True,\n            choices=[\n                'os_image', 'os_network', 'os_volume', 'foreman',\n            ],\n            aliases=['provider'],\n        ),\n    )\n    module = AnsibleModule(argument_spec)\n\n    if module._name == 'ovirt_external_providers_facts':\n        module.deprecate(\"The 'ovirt_external_providers_facts' module is being renamed 'ovirt_external_provider_facts'\", version=2.8)\n\n    check_sdk(module)\n\n    try:\n        auth = module.params.pop('auth')\n        connection = create_connection(auth)\n        external_providers_service = _external_provider_service(\n            provider_type=module.params.pop('type'),\n            system_service=connection.system_service(),\n        )\n        if module.params['name']:\n            external_providers = [\n                e for e in external_providers_service.list()\n                if fnmatch.fnmatch(e.name, module.params['name'])\n            ]\n        else:\n            external_providers = external_providers_service.list()\n\n        module.exit_json(\n            changed=False,\n            ansible_facts=dict(\n                ovirt_external_providers=[\n                    get_dict_of_struct(\n                        struct=c,\n                        connection=connection,\n                        fetch_nested=module.params.get('fetch_nested'),\n                        attributes=module.params.get('nested_attributes'),\n                    ) for c in external_providers\n                ],\n            ),\n        )\n    except Exception as e:\n        module.fail_json(msg=str(e), exception=traceback.format_exc())\n    finally:\n        connection.close(logout=auth.get('token') is None)\n\n\nif __name__ == '__main__':\n    main()\n", "description": "Ansible is a radically simple IT automation platform that makes your applications and systems easier to deploy. Avoid writing scripts or custom code to deploy and update your applications\u2014 automate in a language that approaches plain English, using SSH, with no agents to install on remote systems.", "file_name": "ovirt_external_provider_facts.py", "id": "655ef8a8734cf2755fad07ff5c2b0e10", "language": "Python", "project_name": "ansible", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/ansible-ansible/ansible-ansible-d30554b/lib/ansible/modules/cloud/ovirt/ovirt_external_provider_facts.py", "save_time": "", "source": "", "update_at": "2018-03-18T14:08:28Z", "url": "https://github.com/ansible/ansible", "wiki": false}