{"author": "tgalal", "code": "from yowsup.layers import YowProtocolLayer\nfrom .protocolentities import *\nfrom yowsup.layers.protocol_acks.protocolentities import OutgoingAckProtocolEntity\nfrom yowsup.layers.protocol_receipts.protocolentities import OutgoingReceiptProtocolEntity\nclass YowCallsProtocolLayer(YowProtocolLayer):\n\n    def __init__(self):\n        handleMap = {\n            \"call\": (self.recvCall, self.sendCall)\n        }\n        super(YowCallsProtocolLayer, self).__init__(handleMap)\n\n    def __str__(self):\n        return \"call Layer\"\n\n    def sendCall(self, entity):\n        if entity.getTag() == \"call\":\n            self.toLower(entity.toProtocolTreeNode())\n\n    def recvCall(self, node):\n        entity = CallProtocolEntity.fromProtocolTreeNode(node)\n        if entity.getType() == \"offer\":\n            receipt = OutgoingReceiptProtocolEntity(node[\"id\"], node[\"from\"], callId = entity.getCallId())\n            self.toLower(receipt.toProtocolTreeNode())\n        else:\n            ack = OutgoingAckProtocolEntity(node[\"id\"], \"call\", None, node[\"from\"])\n            self.toLower(ack.toProtocolTreeNode())\n        self.toUpper(entity)\n\n", "comments": "", "content": "from yowsup.layers import YowProtocolLayer\nfrom .protocolentities import *\nfrom yowsup.layers.protocol_acks.protocolentities import OutgoingAckProtocolEntity\nfrom yowsup.layers.protocol_receipts.protocolentities import OutgoingReceiptProtocolEntity\nclass YowCallsProtocolLayer(YowProtocolLayer):\n\n    def __init__(self):\n        handleMap = {\n            \"call\": (self.recvCall, self.sendCall)\n        }\n        super(YowCallsProtocolLayer, self).__init__(handleMap)\n\n    def __str__(self):\n        return \"call Layer\"\n\n    def sendCall(self, entity):\n        if entity.getTag() == \"call\":\n            self.toLower(entity.toProtocolTreeNode())\n\n    def recvCall(self, node):\n        entity = CallProtocolEntity.fromProtocolTreeNode(node)\n        if entity.getType() == \"offer\":\n            receipt = OutgoingReceiptProtocolEntity(node[\"id\"], node[\"from\"], callId = entity.getCallId())\n            self.toLower(receipt.toProtocolTreeNode())\n        else:\n            ack = OutgoingAckProtocolEntity(node[\"id\"], \"call\", None, node[\"from\"])\n            self.toLower(ack.toProtocolTreeNode())\n        self.toUpper(entity)\n\n", "description": "The python WhatsApp library", "file_name": "layer.py", "id": "75a25f4dc0b812a0e4f7fb0784346a6b", "language": "Python", "project_name": "yowsup", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/tgalal-yowsup/tgalal-yowsup-03795cc/yowsup/layers/protocol_calls/layer.py", "save_time": "", "source": "", "update_at": "2018-03-18T13:01:40Z", "url": "https://github.com/tgalal/yowsup", "wiki": true}