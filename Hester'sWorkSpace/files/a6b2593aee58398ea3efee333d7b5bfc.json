{"author": "rg3", "code": "from __future__ import unicode_literals\n\nimport codecs\nimport subprocess\n\nimport os\nimport sys\nsys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))\n\nfrom youtube_dl.utils import intlist_to_bytes\nfrom youtube_dl.aes import aes_encrypt, key_expansion\n\nsecret_msg = b'Secret message goes here'\n\n\ndef hex_str(int_list):\n    return codecs.encode(intlist_to_bytes(int_list), 'hex')\n\n\ndef openssl_encode(algo, key, iv):\n    cmd = ['openssl', 'enc', '-e', '-' + algo, '-K', hex_str(key), '-iv', hex_str(iv)]\n    prog = subprocess.Popen(cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE)\n    out, _ = prog.communicate(secret_msg)\n    return out\n\n\niv = key = [0x20, 0x15] + 14 * [0]\n\nr = openssl_encode('aes-128-cbc', key, iv)\nprint('aes_cbc_decrypt')\nprint(repr(r))\n\npassword = key\nnew_key = aes_encrypt(password, key_expansion(password))\nr = openssl_encode('aes-128-ctr', new_key, iv)\nprint('aes_decrypt_text 16')\nprint(repr(r))\n\npassword = key + 16 * [0]\nnew_key = aes_encrypt(password, key_expansion(password)) * (32 // 16)\nr = openssl_encode('aes-256-ctr', new_key, iv)\nprint('aes_decrypt_text 32')\nprint(repr(r))\n", "comments": "", "content": "from __future__ import unicode_literals\n\nimport codecs\nimport subprocess\n\nimport os\nimport sys\nsys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))\n\nfrom youtube_dl.utils import intlist_to_bytes\nfrom youtube_dl.aes import aes_encrypt, key_expansion\n\nsecret_msg = b'Secret message goes here'\n\n\ndef hex_str(int_list):\n    return codecs.encode(intlist_to_bytes(int_list), 'hex')\n\n\ndef openssl_encode(algo, key, iv):\n    cmd = ['openssl', 'enc', '-e', '-' + algo, '-K', hex_str(key), '-iv', hex_str(iv)]\n    prog = subprocess.Popen(cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE)\n    out, _ = prog.communicate(secret_msg)\n    return out\n\n\niv = key = [0x20, 0x15] + 14 * [0]\n\nr = openssl_encode('aes-128-cbc', key, iv)\nprint('aes_cbc_decrypt')\nprint(repr(r))\n\npassword = key\nnew_key = aes_encrypt(password, key_expansion(password))\nr = openssl_encode('aes-128-ctr', new_key, iv)\nprint('aes_decrypt_text 16')\nprint(repr(r))\n\npassword = key + 16 * [0]\nnew_key = aes_encrypt(password, key_expansion(password)) * (32 // 16)\nr = openssl_encode('aes-256-ctr', new_key, iv)\nprint('aes_decrypt_text 32')\nprint(repr(r))\n", "description": "Command-line program to download videos from YouTube.com and other video sites", "file_name": "generate_aes_testdata.py", "language": "Python", "project_name": "youtube-dl", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/rg3_youtube-dl/rg3-youtube-dl-6202f08/devscripts/generate_aes_testdata.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:18:39Z", "url": "https://github.com/rg3/youtube-dl", "wiki": false}