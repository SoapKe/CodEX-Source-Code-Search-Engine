{"author": "rg3", "code": "\nfrom __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    determine_ext,\n    int_or_none,\n    parse_iso8601,\n    qualities,\n)\n\n\nclass NDRBaseIE(InfoExtractor):\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        display_id = next(group for group in mobj.groups() if group)\n        webpage = self._download_webpage(url, display_id)\n        return self._extract_embed(webpage, display_id)\n\n\nclass NDRIE(NDRBaseIE):\n    IE_NAME = 'ndr'\n    IE_DESC = 'NDR.de - Norddeutscher Rundfunk'\n    _VALID_URL = r'https?://(?:www\\.)?ndr\\.de/(?:[^/]+/)*(?P<id>[^/?\n    _TESTS = [{\n        \n        'url': 'http://www.ndr.de/fernsehen/Party-Poette-und-Parade,hafengeburtstag988.html',\n        'md5': '6515bc255dc5c5f8c85bbc38e035a659',\n        'info_dict': {\n            'id': 'hafengeburtstag988',\n            'display_id': 'Party-Poette-und-Parade',\n            'ext': 'mp4',\n            'title': 'Party, P\u00f6tte und Parade',\n            'description': 'md5:ad14f9d2f91d3040b6930c697e5f6b4c',\n            'uploader': 'ndrtv',\n            'timestamp': 1431108900,\n            'upload_date': '20150510',\n            'duration': 3498,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        \n        'url': 'http://www.ndr.de/sport/fussball/40-Osnabrueck-spielt-sich-in-einen-Rausch,osna270.html',\n        'md5': '1043ff203eab307f0c51702ec49e9a71',\n        'info_dict': {\n            'id': 'osna272',\n            'display_id': '40-Osnabrueck-spielt-sich-in-einen-Rausch',\n            'ext': 'mp4',\n            'title': 'Osnabr\u00fcck - Wehen Wiesbaden: Die Highlights',\n            'description': 'md5:32e9b800b3d2d4008103752682d5dc01',\n            'uploader': 'ndrtv',\n            'timestamp': 1442059200,\n            'upload_date': '20150912',\n            'duration': 510,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        \n        'url': 'http://www.ndr.de/info/La-Valette-entgeht-der-Hinrichtung,audio51535.html',\n        'md5': 'bb3cd38e24fbcc866d13b50ca59307b8',\n        'info_dict': {\n            'id': 'audio51535',\n            'display_id': 'La-Valette-entgeht-der-Hinrichtung',\n            'ext': 'mp3',\n            'title': 'La Valette entgeht der Hinrichtung',\n            'description': 'md5:22f9541913a40fe50091d5cdd7c9f536',\n            'uploader': 'ndrinfo',\n            'timestamp': 1290626100,\n            'upload_date': '20140729',\n            'duration': 884,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'https://www.ndr.de/Fettes-Brot-Ferris-MC-und-Thees-Uhlmann-live-on-stage,festivalsommer116.html',\n        'only_matching': True,\n    }]\n\n    def _extract_embed(self, webpage, display_id):\n        embed_url = self._html_search_meta(\n            'embedURL', webpage, 'embed URL', fatal=True)\n        description = self._search_regex(\n            r'<p[^>]+itemprop=\"description\">([^<]+)</p>',\n            webpage, 'description', default=None) or self._og_search_description(webpage)\n        timestamp = parse_iso8601(\n            self._search_regex(\n                r'<span[^>]+itemprop=\"(?:datePublished|uploadDate)\"[^>]+content=\"([^\"]+)\"',\n                webpage, 'upload date', fatal=False))\n        return {\n            '_type': 'url_transparent',\n            'url': embed_url,\n            'display_id': display_id,\n            'description': description,\n            'timestamp': timestamp,\n        }\n\n\nclass NJoyIE(NDRBaseIE):\n    IE_NAME = 'njoy'\n    IE_DESC = 'N-JOY'\n    _VALID_URL = r'https?://(?:www\\.)?n-joy\\.de/(?:[^/]+/)*(?:(?P<display_id>[^/?\n    _TESTS = [{\n        \n        'url': 'http://www.n-joy.de/entertainment/comedy/comedy_contest/Benaissa-beim-NDR-Comedy-Contest,comedycontest2480.html',\n        'md5': 'cb63be60cd6f9dd75218803146d8dc67',\n        'info_dict': {\n            'id': 'comedycontest2480',\n            'display_id': 'Benaissa-beim-NDR-Comedy-Contest',\n            'ext': 'mp4',\n            'title': 'Benaissa beim NDR Comedy Contest',\n            'description': 'md5:f057a6c4e1c728b10d33b5ffd36ddc39',\n            'uploader': 'ndrtv',\n            'upload_date': '20141129',\n            'duration': 654,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        \n        'url': 'http://www.n-joy.de/musik/Das-frueheste-DJ-Set-des-Nordens-live-mit-Felix-Jaehn-,felixjaehn168.html',\n        'md5': '417660fffa90e6df2fda19f1b40a64d8',\n        'info_dict': {\n            'id': 'dockville882',\n            'display_id': 'Das-frueheste-DJ-Set-des-Nordens-live-mit-Felix-Jaehn-',\n            'ext': 'mp4',\n            'title': '\"Ich hab noch nie\" mit Felix Jaehn',\n            'description': 'md5:85dd312d53be1b99e1f998a16452a2f3',\n            'uploader': 'njoy',\n            'upload_date': '20150822',\n            'duration': 211,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.n-joy.de/radio/webradio/morningshow209.html',\n        'only_matching': True,\n    }]\n\n    def _extract_embed(self, webpage, display_id):\n        video_id = self._search_regex(\n            r'<iframe[^>]+id=\"pp_([\\da-z]+)\"', webpage, 'embed id')\n        description = self._search_regex(\n            r'<div[^>]+class=\"subline\"[^>]*>[^<]+</div>\\s*<p>([^<]+)</p>',\n            webpage, 'description', fatal=False)\n        return {\n            '_type': 'url_transparent',\n            'ie_key': 'NDREmbedBase',\n            'url': 'ndr:%s' % video_id,\n            'display_id': display_id,\n            'description': description,\n        }\n\n\nclass NDREmbedBaseIE(InfoExtractor):\n    IE_NAME = 'ndr:embed:base'\n    _VALID_URL = r'(?:ndr:(?P<id_s>[\\da-z]+)|https?://www\\.ndr\\.de/(?P<id>[\\da-z]+)-ppjson\\.json)'\n    _TESTS = [{\n        'url': 'ndr:soundcheck3366',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/soundcheck3366-ppjson.json',\n        'only_matching': True,\n    }]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        video_id = mobj.group('id') or mobj.group('id_s')\n\n        ppjson = self._download_json(\n            'http://www.ndr.de/%s-ppjson.json' % video_id, video_id)\n\n        playlist = ppjson['playlist']\n\n        formats = []\n        quality_key = qualities(('xs', 's', 'm', 'l', 'xl'))\n\n        for format_id, f in playlist.items():\n            src = f.get('src')\n            if not src:\n                continue\n            ext = determine_ext(src, None)\n            if ext == 'f4m':\n                formats.extend(self._extract_f4m_formats(\n                    src + '?hdcore=3.7.0&plugin=aasp-3.7.0.39.44', video_id,\n                    f4m_id='hds', fatal=False))\n            elif ext == 'm3u8':\n                formats.extend(self._extract_m3u8_formats(\n                    src, video_id, 'mp4', m3u8_id='hls',\n                    entry_protocol='m3u8_native', fatal=False))\n            else:\n                quality = f.get('quality')\n                ff = {\n                    'url': src,\n                    'format_id': quality or format_id,\n                    'quality': quality_key(quality),\n                }\n                type_ = f.get('type')\n                if type_ and type_.split('/')[0] == 'audio':\n                    ff['vcodec'] = 'none'\n                    ff['ext'] = ext or 'mp3'\n                formats.append(ff)\n        self._sort_formats(formats)\n\n        config = playlist['config']\n\n        live = playlist.get('config', {}).get('streamType') in ['httpVideoLive', 'httpAudioLive']\n        title = config['title']\n        if live:\n            title = self._live_title(title)\n        uploader = ppjson.get('config', {}).get('branding')\n        upload_date = ppjson.get('config', {}).get('publicationDate')\n        duration = int_or_none(config.get('duration'))\n\n        thumbnails = [{\n            'id': thumbnail.get('quality') or thumbnail_id,\n            'url': thumbnail['src'],\n            'preference': quality_key(thumbnail.get('quality')),\n        } for thumbnail_id, thumbnail in config.get('poster', {}).items() if thumbnail.get('src')]\n\n        return {\n            'id': video_id,\n            'title': title,\n            'is_live': live,\n            'uploader': uploader if uploader != '-' else None,\n            'upload_date': upload_date[0:8] if upload_date else None,\n            'duration': duration,\n            'thumbnails': thumbnails,\n            'formats': formats,\n        }\n\n\nclass NDREmbedIE(NDREmbedBaseIE):\n    IE_NAME = 'ndr:embed'\n    _VALID_URL = r'https?://(?:www\\.)?ndr\\.de/(?:[^/]+/)*(?P<id>[\\da-z]+)-(?:player|externalPlayer)\\.html'\n    _TESTS = [{\n        'url': 'http://www.ndr.de/fernsehen/sendungen/ndr_aktuell/ndraktuell28488-player.html',\n        'md5': '8b9306142fe65bbdefb5ce24edb6b0a9',\n        'info_dict': {\n            'id': 'ndraktuell28488',\n            'ext': 'mp4',\n            'title': 'Norddeutschland begr\u00fc\u00dft Fl\u00fcchtlinge',\n            'is_live': False,\n            'uploader': 'ndrtv',\n            'upload_date': '20150907',\n            'duration': 132,\n        },\n    }, {\n        'url': 'http://www.ndr.de/ndr2/events/soundcheck/soundcheck3366-player.html',\n        'md5': '002085c44bae38802d94ae5802a36e78',\n        'info_dict': {\n            'id': 'soundcheck3366',\n            'ext': 'mp4',\n            'title': 'Ella Henderson braucht Vergleiche nicht zu scheuen',\n            'is_live': False,\n            'uploader': 'ndr2',\n            'upload_date': '20150912',\n            'duration': 3554,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.ndr.de/info/audio51535-player.html',\n        'md5': 'bb3cd38e24fbcc866d13b50ca59307b8',\n        'info_dict': {\n            'id': 'audio51535',\n            'ext': 'mp3',\n            'title': 'La Valette entgeht der Hinrichtung',\n            'is_live': False,\n            'uploader': 'ndrinfo',\n            'upload_date': '20140729',\n            'duration': 884,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/visite/visite11010-externalPlayer.html',\n        'md5': 'ae57f80511c1e1f2fd0d0d3d31aeae7c',\n        'info_dict': {\n            'id': 'visite11010',\n            'ext': 'mp4',\n            'title': 'Visite - die ganze Sendung',\n            'is_live': False,\n            'uploader': 'ndrtv',\n            'upload_date': '20150902',\n            'duration': 3525,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        \n        'url': 'http://www.ndr.de/fernsehen/livestream/livestream217-externalPlayer.html',\n        'info_dict': {\n            'id': 'livestream217',\n            'ext': 'flv',\n            'title': r're:^NDR Fernsehen Niedersachsen \\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}$',\n            'is_live': True,\n            'upload_date': '20150910',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.ndr.de/ndrkultur/audio255020-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/nordtour/nordtour7124-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/kultur/film/videos/videoimport10424-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/hamburg_journal/hamj43006-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/weltbilder/weltbilder4518-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/doku952-player.html',\n        'only_matching': True,\n    }]\n\n\nclass NJoyEmbedIE(NDREmbedBaseIE):\n    IE_NAME = 'njoy:embed'\n    _VALID_URL = r'https?://(?:www\\.)?n-joy\\.de/(?:[^/]+/)*(?P<id>[\\da-z]+)-(?:player|externalPlayer)_[^/]+\\.html'\n    _TESTS = [{\n        \n        'url': 'http://www.n-joy.de/events/reeperbahnfestival/doku948-player_image-bc168e87-5263-4d6d-bd27-bb643005a6de_theme-n-joy.html',\n        'md5': '8483cbfe2320bd4d28a349d62d88bd74',\n        'info_dict': {\n            'id': 'doku948',\n            'ext': 'mp4',\n            'title': 'Zehn Jahre Reeperbahn Festival - die Doku',\n            'is_live': False,\n            'upload_date': '20150807',\n            'duration': 1011,\n        },\n    }, {\n        \n        'url': 'http://www.n-joy.de/news_wissen/stefanrichter100-player_image-d5e938b1-f21a-4b9a-86b8-aaba8bca3a13_theme-n-joy.html',\n        'md5': 'd989f80f28ac954430f7b8a48197188a',\n        'info_dict': {\n            'id': 'stefanrichter100',\n            'ext': 'mp3',\n            'title': 'Interview mit einem Augenzeugen',\n            'is_live': False,\n            'uploader': 'njoy',\n            'upload_date': '20150909',\n            'duration': 140,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        \n        'url': 'http://www.n-joy.de/news_wissen/webradioweltweit100-player_image-3fec0484-2244-4565-8fb8-ed25fd28b173_theme-n-joy.html',\n        'info_dict': {\n            'id': 'webradioweltweit100',\n            'ext': 'mp3',\n            'title': r're:^N-JOY Weltweit \\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}$',\n            'is_live': True,\n            'uploader': 'njoy',\n            'upload_date': '20150810',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.n-joy.de/musik/dockville882-player_image-3905259e-0803-4764-ac72-8b7de077d80a_theme-n-joy.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.n-joy.de/radio/sendungen/morningshow/urlaubsfotos190-player_image-066a5df1-5c95-49ec-a323-941d848718db_theme-n-joy.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.n-joy.de/entertainment/comedy/krudetv290-player_image-ab261bfe-51bf-4bf3-87ba-c5122ee35b3d_theme-n-joy.html',\n        'only_matching': True,\n    }]\n", "comments": "# coding: utf-8\n#]+),[\\da-z]+\\.html'\n# httpVideo, same content id\n# httpVideo, different content id\n# httpAudio, same content id\n#]+),)?(?P<id>[\\da-z]+)\\.html'\n# httpVideo, same content id\n# httpVideo, different content id\n# httpVideoLive\n# httpVideo\n# httpAudio\n# httpAudioLive, no explicit ext\n", "content": "# coding: utf-8\nfrom __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    determine_ext,\n    int_or_none,\n    parse_iso8601,\n    qualities,\n)\n\n\nclass NDRBaseIE(InfoExtractor):\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        display_id = next(group for group in mobj.groups() if group)\n        webpage = self._download_webpage(url, display_id)\n        return self._extract_embed(webpage, display_id)\n\n\nclass NDRIE(NDRBaseIE):\n    IE_NAME = 'ndr'\n    IE_DESC = 'NDR.de - Norddeutscher Rundfunk'\n    _VALID_URL = r'https?://(?:www\\.)?ndr\\.de/(?:[^/]+/)*(?P<id>[^/?#]+),[\\da-z]+\\.html'\n    _TESTS = [{\n        # httpVideo, same content id\n        'url': 'http://www.ndr.de/fernsehen/Party-Poette-und-Parade,hafengeburtstag988.html',\n        'md5': '6515bc255dc5c5f8c85bbc38e035a659',\n        'info_dict': {\n            'id': 'hafengeburtstag988',\n            'display_id': 'Party-Poette-und-Parade',\n            'ext': 'mp4',\n            'title': 'Party, P\u00f6tte und Parade',\n            'description': 'md5:ad14f9d2f91d3040b6930c697e5f6b4c',\n            'uploader': 'ndrtv',\n            'timestamp': 1431108900,\n            'upload_date': '20150510',\n            'duration': 3498,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        # httpVideo, different content id\n        'url': 'http://www.ndr.de/sport/fussball/40-Osnabrueck-spielt-sich-in-einen-Rausch,osna270.html',\n        'md5': '1043ff203eab307f0c51702ec49e9a71',\n        'info_dict': {\n            'id': 'osna272',\n            'display_id': '40-Osnabrueck-spielt-sich-in-einen-Rausch',\n            'ext': 'mp4',\n            'title': 'Osnabr\u00fcck - Wehen Wiesbaden: Die Highlights',\n            'description': 'md5:32e9b800b3d2d4008103752682d5dc01',\n            'uploader': 'ndrtv',\n            'timestamp': 1442059200,\n            'upload_date': '20150912',\n            'duration': 510,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        # httpAudio, same content id\n        'url': 'http://www.ndr.de/info/La-Valette-entgeht-der-Hinrichtung,audio51535.html',\n        'md5': 'bb3cd38e24fbcc866d13b50ca59307b8',\n        'info_dict': {\n            'id': 'audio51535',\n            'display_id': 'La-Valette-entgeht-der-Hinrichtung',\n            'ext': 'mp3',\n            'title': 'La Valette entgeht der Hinrichtung',\n            'description': 'md5:22f9541913a40fe50091d5cdd7c9f536',\n            'uploader': 'ndrinfo',\n            'timestamp': 1290626100,\n            'upload_date': '20140729',\n            'duration': 884,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'https://www.ndr.de/Fettes-Brot-Ferris-MC-und-Thees-Uhlmann-live-on-stage,festivalsommer116.html',\n        'only_matching': True,\n    }]\n\n    def _extract_embed(self, webpage, display_id):\n        embed_url = self._html_search_meta(\n            'embedURL', webpage, 'embed URL', fatal=True)\n        description = self._search_regex(\n            r'<p[^>]+itemprop=\"description\">([^<]+)</p>',\n            webpage, 'description', default=None) or self._og_search_description(webpage)\n        timestamp = parse_iso8601(\n            self._search_regex(\n                r'<span[^>]+itemprop=\"(?:datePublished|uploadDate)\"[^>]+content=\"([^\"]+)\"',\n                webpage, 'upload date', fatal=False))\n        return {\n            '_type': 'url_transparent',\n            'url': embed_url,\n            'display_id': display_id,\n            'description': description,\n            'timestamp': timestamp,\n        }\n\n\nclass NJoyIE(NDRBaseIE):\n    IE_NAME = 'njoy'\n    IE_DESC = 'N-JOY'\n    _VALID_URL = r'https?://(?:www\\.)?n-joy\\.de/(?:[^/]+/)*(?:(?P<display_id>[^/?#]+),)?(?P<id>[\\da-z]+)\\.html'\n    _TESTS = [{\n        # httpVideo, same content id\n        'url': 'http://www.n-joy.de/entertainment/comedy/comedy_contest/Benaissa-beim-NDR-Comedy-Contest,comedycontest2480.html',\n        'md5': 'cb63be60cd6f9dd75218803146d8dc67',\n        'info_dict': {\n            'id': 'comedycontest2480',\n            'display_id': 'Benaissa-beim-NDR-Comedy-Contest',\n            'ext': 'mp4',\n            'title': 'Benaissa beim NDR Comedy Contest',\n            'description': 'md5:f057a6c4e1c728b10d33b5ffd36ddc39',\n            'uploader': 'ndrtv',\n            'upload_date': '20141129',\n            'duration': 654,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        # httpVideo, different content id\n        'url': 'http://www.n-joy.de/musik/Das-frueheste-DJ-Set-des-Nordens-live-mit-Felix-Jaehn-,felixjaehn168.html',\n        'md5': '417660fffa90e6df2fda19f1b40a64d8',\n        'info_dict': {\n            'id': 'dockville882',\n            'display_id': 'Das-frueheste-DJ-Set-des-Nordens-live-mit-Felix-Jaehn-',\n            'ext': 'mp4',\n            'title': '\"Ich hab noch nie\" mit Felix Jaehn',\n            'description': 'md5:85dd312d53be1b99e1f998a16452a2f3',\n            'uploader': 'njoy',\n            'upload_date': '20150822',\n            'duration': 211,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.n-joy.de/radio/webradio/morningshow209.html',\n        'only_matching': True,\n    }]\n\n    def _extract_embed(self, webpage, display_id):\n        video_id = self._search_regex(\n            r'<iframe[^>]+id=\"pp_([\\da-z]+)\"', webpage, 'embed id')\n        description = self._search_regex(\n            r'<div[^>]+class=\"subline\"[^>]*>[^<]+</div>\\s*<p>([^<]+)</p>',\n            webpage, 'description', fatal=False)\n        return {\n            '_type': 'url_transparent',\n            'ie_key': 'NDREmbedBase',\n            'url': 'ndr:%s' % video_id,\n            'display_id': display_id,\n            'description': description,\n        }\n\n\nclass NDREmbedBaseIE(InfoExtractor):\n    IE_NAME = 'ndr:embed:base'\n    _VALID_URL = r'(?:ndr:(?P<id_s>[\\da-z]+)|https?://www\\.ndr\\.de/(?P<id>[\\da-z]+)-ppjson\\.json)'\n    _TESTS = [{\n        'url': 'ndr:soundcheck3366',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/soundcheck3366-ppjson.json',\n        'only_matching': True,\n    }]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        video_id = mobj.group('id') or mobj.group('id_s')\n\n        ppjson = self._download_json(\n            'http://www.ndr.de/%s-ppjson.json' % video_id, video_id)\n\n        playlist = ppjson['playlist']\n\n        formats = []\n        quality_key = qualities(('xs', 's', 'm', 'l', 'xl'))\n\n        for format_id, f in playlist.items():\n            src = f.get('src')\n            if not src:\n                continue\n            ext = determine_ext(src, None)\n            if ext == 'f4m':\n                formats.extend(self._extract_f4m_formats(\n                    src + '?hdcore=3.7.0&plugin=aasp-3.7.0.39.44', video_id,\n                    f4m_id='hds', fatal=False))\n            elif ext == 'm3u8':\n                formats.extend(self._extract_m3u8_formats(\n                    src, video_id, 'mp4', m3u8_id='hls',\n                    entry_protocol='m3u8_native', fatal=False))\n            else:\n                quality = f.get('quality')\n                ff = {\n                    'url': src,\n                    'format_id': quality or format_id,\n                    'quality': quality_key(quality),\n                }\n                type_ = f.get('type')\n                if type_ and type_.split('/')[0] == 'audio':\n                    ff['vcodec'] = 'none'\n                    ff['ext'] = ext or 'mp3'\n                formats.append(ff)\n        self._sort_formats(formats)\n\n        config = playlist['config']\n\n        live = playlist.get('config', {}).get('streamType') in ['httpVideoLive', 'httpAudioLive']\n        title = config['title']\n        if live:\n            title = self._live_title(title)\n        uploader = ppjson.get('config', {}).get('branding')\n        upload_date = ppjson.get('config', {}).get('publicationDate')\n        duration = int_or_none(config.get('duration'))\n\n        thumbnails = [{\n            'id': thumbnail.get('quality') or thumbnail_id,\n            'url': thumbnail['src'],\n            'preference': quality_key(thumbnail.get('quality')),\n        } for thumbnail_id, thumbnail in config.get('poster', {}).items() if thumbnail.get('src')]\n\n        return {\n            'id': video_id,\n            'title': title,\n            'is_live': live,\n            'uploader': uploader if uploader != '-' else None,\n            'upload_date': upload_date[0:8] if upload_date else None,\n            'duration': duration,\n            'thumbnails': thumbnails,\n            'formats': formats,\n        }\n\n\nclass NDREmbedIE(NDREmbedBaseIE):\n    IE_NAME = 'ndr:embed'\n    _VALID_URL = r'https?://(?:www\\.)?ndr\\.de/(?:[^/]+/)*(?P<id>[\\da-z]+)-(?:player|externalPlayer)\\.html'\n    _TESTS = [{\n        'url': 'http://www.ndr.de/fernsehen/sendungen/ndr_aktuell/ndraktuell28488-player.html',\n        'md5': '8b9306142fe65bbdefb5ce24edb6b0a9',\n        'info_dict': {\n            'id': 'ndraktuell28488',\n            'ext': 'mp4',\n            'title': 'Norddeutschland begr\u00fc\u00dft Fl\u00fcchtlinge',\n            'is_live': False,\n            'uploader': 'ndrtv',\n            'upload_date': '20150907',\n            'duration': 132,\n        },\n    }, {\n        'url': 'http://www.ndr.de/ndr2/events/soundcheck/soundcheck3366-player.html',\n        'md5': '002085c44bae38802d94ae5802a36e78',\n        'info_dict': {\n            'id': 'soundcheck3366',\n            'ext': 'mp4',\n            'title': 'Ella Henderson braucht Vergleiche nicht zu scheuen',\n            'is_live': False,\n            'uploader': 'ndr2',\n            'upload_date': '20150912',\n            'duration': 3554,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.ndr.de/info/audio51535-player.html',\n        'md5': 'bb3cd38e24fbcc866d13b50ca59307b8',\n        'info_dict': {\n            'id': 'audio51535',\n            'ext': 'mp3',\n            'title': 'La Valette entgeht der Hinrichtung',\n            'is_live': False,\n            'uploader': 'ndrinfo',\n            'upload_date': '20140729',\n            'duration': 884,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/visite/visite11010-externalPlayer.html',\n        'md5': 'ae57f80511c1e1f2fd0d0d3d31aeae7c',\n        'info_dict': {\n            'id': 'visite11010',\n            'ext': 'mp4',\n            'title': 'Visite - die ganze Sendung',\n            'is_live': False,\n            'uploader': 'ndrtv',\n            'upload_date': '20150902',\n            'duration': 3525,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        # httpVideoLive\n        'url': 'http://www.ndr.de/fernsehen/livestream/livestream217-externalPlayer.html',\n        'info_dict': {\n            'id': 'livestream217',\n            'ext': 'flv',\n            'title': r're:^NDR Fernsehen Niedersachsen \\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}$',\n            'is_live': True,\n            'upload_date': '20150910',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.ndr.de/ndrkultur/audio255020-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/nordtour/nordtour7124-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/kultur/film/videos/videoimport10424-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/hamburg_journal/hamj43006-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/sendungen/weltbilder/weltbilder4518-player.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.ndr.de/fernsehen/doku952-player.html',\n        'only_matching': True,\n    }]\n\n\nclass NJoyEmbedIE(NDREmbedBaseIE):\n    IE_NAME = 'njoy:embed'\n    _VALID_URL = r'https?://(?:www\\.)?n-joy\\.de/(?:[^/]+/)*(?P<id>[\\da-z]+)-(?:player|externalPlayer)_[^/]+\\.html'\n    _TESTS = [{\n        # httpVideo\n        'url': 'http://www.n-joy.de/events/reeperbahnfestival/doku948-player_image-bc168e87-5263-4d6d-bd27-bb643005a6de_theme-n-joy.html',\n        'md5': '8483cbfe2320bd4d28a349d62d88bd74',\n        'info_dict': {\n            'id': 'doku948',\n            'ext': 'mp4',\n            'title': 'Zehn Jahre Reeperbahn Festival - die Doku',\n            'is_live': False,\n            'upload_date': '20150807',\n            'duration': 1011,\n        },\n    }, {\n        # httpAudio\n        'url': 'http://www.n-joy.de/news_wissen/stefanrichter100-player_image-d5e938b1-f21a-4b9a-86b8-aaba8bca3a13_theme-n-joy.html',\n        'md5': 'd989f80f28ac954430f7b8a48197188a',\n        'info_dict': {\n            'id': 'stefanrichter100',\n            'ext': 'mp3',\n            'title': 'Interview mit einem Augenzeugen',\n            'is_live': False,\n            'uploader': 'njoy',\n            'upload_date': '20150909',\n            'duration': 140,\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        # httpAudioLive, no explicit ext\n        'url': 'http://www.n-joy.de/news_wissen/webradioweltweit100-player_image-3fec0484-2244-4565-8fb8-ed25fd28b173_theme-n-joy.html',\n        'info_dict': {\n            'id': 'webradioweltweit100',\n            'ext': 'mp3',\n            'title': r're:^N-JOY Weltweit \\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}$',\n            'is_live': True,\n            'uploader': 'njoy',\n            'upload_date': '20150810',\n        },\n        'params': {\n            'skip_download': True,\n        },\n    }, {\n        'url': 'http://www.n-joy.de/musik/dockville882-player_image-3905259e-0803-4764-ac72-8b7de077d80a_theme-n-joy.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.n-joy.de/radio/sendungen/morningshow/urlaubsfotos190-player_image-066a5df1-5c95-49ec-a323-941d848718db_theme-n-joy.html',\n        'only_matching': True,\n    }, {\n        'url': 'http://www.n-joy.de/entertainment/comedy/krudetv290-player_image-ab261bfe-51bf-4bf3-87ba-c5122ee35b3d_theme-n-joy.html',\n        'only_matching': True,\n    }]\n", "description": "Command-line program to download videos from YouTube.com and other video sites", "file_name": "ndr.py", "language": "Python", "project_name": "youtube-dl", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/rg3_youtube-dl/rg3-youtube-dl-6202f08/youtube_dl/extractor/ndr.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:18:39Z", "url": "https://github.com/rg3/youtube-dl", "wiki": false}