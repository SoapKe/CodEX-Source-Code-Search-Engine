{"author": "rg3", "code": "from __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    int_or_none,\n    parse_iso8601,\n)\n\n\nclass IGNIE(InfoExtractor):\n    \n\n    _VALID_URL = r'https?://.+?\\.ign\\.com/(?:[^/]+/)?(?P<type>videos|show_videos|articles|feature|(?:[^/]+/\\d+/video))(/.+)?/(?P<name_or_id>.+)'\n    IE_NAME = 'ign.com'\n\n    _API_URL_TEMPLATE = 'http://apis.ign.com/video/v3/videos/%s'\n    _EMBED_RE = r'<iframe[^>]+?[\"\\']((?:https?:)?//.+?\\.ign\\.com.+?/embed.+?)[\"\\']'\n\n    _TESTS = [\n        {\n            'url': 'http://www.ign.com/videos/2013/06/05/the-last-of-us-review',\n            'md5': 'febda82c4bafecd2d44b6e1a18a595f8',\n            'info_dict': {\n                'id': '8f862beef863986b2785559b9e1aa599',\n                'ext': 'mp4',\n                'title': 'The Last of Us Review',\n                'description': 'md5:c8946d4260a4d43a00d5ae8ed998870c',\n                'timestamp': 1370440800,\n                'upload_date': '20130605',\n                'uploader_id': 'cberidon@ign.com',\n            }\n        },\n        {\n            'url': 'http://me.ign.com/en/feature/15775/100-little-things-in-gta-5-that-will-blow-your-mind',\n            'info_dict': {\n                'id': '100-little-things-in-gta-5-that-will-blow-your-mind',\n            },\n            'playlist': [\n                {\n                    'info_dict': {\n                        'id': '5ebbd138523268b93c9141af17bec937',\n                        'ext': 'mp4',\n                        'title': 'GTA 5 Video Review',\n                        'description': 'Rockstar drops the mic on this generation of games. Watch our review of the masterly Grand Theft Auto V.',\n                        'timestamp': 1379339880,\n                        'upload_date': '20130916',\n                        'uploader_id': 'danieljkrupa@gmail.com',\n                    },\n                },\n                {\n                    'info_dict': {\n                        'id': '638672ee848ae4ff108df2a296418ee2',\n                        'ext': 'mp4',\n                        'title': '26 Twisted Moments from GTA 5 in Slow Motion',\n                        'description': 'The twisted beauty of GTA 5 in stunning slow motion.',\n                        'timestamp': 1386878820,\n                        'upload_date': '20131212',\n                        'uploader_id': 'togilvie@ign.com',\n                    },\n                },\n            ],\n            'params': {\n                'skip_download': True,\n            },\n        },\n        {\n            'url': 'http://www.ign.com/articles/2014/08/15/rewind-theater-wild-trailer-gamescom-2014?watch',\n            'md5': '618fedb9c901fd086f6f093564ef8558',\n            'info_dict': {\n                'id': '078fdd005f6d3c02f63d795faa1b984f',\n                'ext': 'mp4',\n                'title': 'Rewind Theater - Wild Trailer Gamescom 2014',\n                'description': 'Brian and Jared explore Michel Ancel\\'s captivating new preview.',\n                'timestamp': 1408047180,\n                'upload_date': '20140814',\n                'uploader_id': 'jamesduggan1990@gmail.com',\n            },\n        },\n        {\n            'url': 'http://me.ign.com/en/videos/112203/video/how-hitman-aims-to-be-different-than-every-other-s',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://me.ign.com/ar/angry-birds-2/106533/video/lrd-ldyy-lwl-lfylm-angry-birds',\n            'only_matching': True,\n        },\n        {\n            \n            'url': 'http://www.ign.com/articles/2017/06/08/new-ducktales-short-donalds-birthday-doesnt-go-as-planned',\n            'only_matching': True,\n        },\n    ]\n\n    def _find_video_id(self, webpage):\n        res_id = [\n            r'\"video_id\"\\s*:\\s*\"(.*?)\"',\n            r'class=\"hero-poster[^\"]*?\"[^>]*id=\"(.+?)\"',\n            r'data-video-id=\"(.+?)\"',\n            r'<object id=\"vid_(.+?)\"',\n            r'<meta name=\"og:image\" content=\".*/(.+?)-(.+?)/.+.jpg\"',\n            r'videoId&quot;\\s*:\\s*&quot;(.+?)&quot;',\n            r'videoId[\"\\']\\s*:\\s*[\"\\']([^\"\\']+?)[\"\\']',\n        ]\n        return self._search_regex(res_id, webpage, 'video id', default=None)\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        name_or_id = mobj.group('name_or_id')\n        page_type = mobj.group('type')\n        webpage = self._download_webpage(url, name_or_id)\n        if page_type != 'video':\n            multiple_urls = re.findall(\n                r'<param name=\"flashvars\"[^>]*value=\"[^\"]*?url=(https?://www\\.ign\\.com/videos/.*?)[\"&]',\n                webpage)\n            if multiple_urls:\n                entries = [self.url_result(u, ie='IGN') for u in multiple_urls]\n                return {\n                    '_type': 'playlist',\n                    'id': name_or_id,\n                    'entries': entries,\n                }\n\n        video_id = self._find_video_id(webpage)\n        if not video_id:\n            return self.url_result(self._search_regex(\n                self._EMBED_RE, webpage, 'embed url'))\n        return self._get_video_info(video_id)\n\n    def _get_video_info(self, video_id):\n        api_data = self._download_json(\n            self._API_URL_TEMPLATE % video_id, video_id)\n\n        formats = []\n        m3u8_url = api_data['refs'].get('m3uUrl')\n        if m3u8_url:\n            formats.extend(self._extract_m3u8_formats(\n                m3u8_url, video_id, 'mp4', 'm3u8_native',\n                m3u8_id='hls', fatal=False))\n        f4m_url = api_data['refs'].get('f4mUrl')\n        if f4m_url:\n            formats.extend(self._extract_f4m_formats(\n                f4m_url, video_id, f4m_id='hds', fatal=False))\n        for asset in api_data['assets']:\n            formats.append({\n                'url': asset['url'],\n                'tbr': asset.get('actual_bitrate_kbps'),\n                'fps': asset.get('frame_rate'),\n                'height': int_or_none(asset.get('height')),\n                'width': int_or_none(asset.get('width')),\n            })\n        self._sort_formats(formats)\n\n        thumbnails = [{\n            'url': thumbnail['url']\n        } for thumbnail in api_data.get('thumbnails', [])]\n\n        metadata = api_data['metadata']\n\n        return {\n            'id': api_data.get('videoId') or video_id,\n            'title': metadata.get('longTitle') or metadata.get('name') or metadata.get['title'],\n            'description': metadata.get('description'),\n            'timestamp': parse_iso8601(metadata.get('publishDate')),\n            'duration': int_or_none(metadata.get('duration')),\n            'display_id': metadata.get('slug') or video_id,\n            'uploader_id': metadata.get('creator'),\n            'thumbnails': thumbnails,\n            'formats': formats,\n        }\n\n\nclass OneUPIE(IGNIE):\n    _VALID_URL = r'https?://gamevideos\\.1up\\.com/(?P<type>video)/id/(?P<name_or_id>.+)\\.html'\n    IE_NAME = '1up.com'\n\n    _TESTS = [{\n        'url': 'http://gamevideos.1up.com/video/id/34976.html',\n        'md5': 'c9cc69e07acb675c31a16719f909e347',\n        'info_dict': {\n            'id': '34976',\n            'ext': 'mp4',\n            'title': 'Sniper Elite V2 - Trailer',\n            'description': 'md5:bf0516c5ee32a3217aa703e9b1bc7826',\n            'timestamp': 1313099220,\n            'upload_date': '20110811',\n            'uploader_id': 'IGN',\n        }\n    }]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        result = super(OneUPIE, self)._real_extract(url)\n        result['id'] = mobj.group('name_or_id')\n        return result\n\n\nclass PCMagIE(IGNIE):\n    _VALID_URL = r'https?://(?:www\\.)?pcmag\\.com/(?P<type>videos|article2)(/.+)?/(?P<name_or_id>.+)'\n    IE_NAME = 'pcmag'\n\n    _EMBED_RE = r'iframe\\.setAttribute\\(\"src\",\\s*__util.objToUrlString\\(\"http://widgets\\.ign\\.com/video/embed/content\\.html?[^\"]*url=([^\"]+)[\"&]'\n\n    _TESTS = [{\n        'url': 'http://www.pcmag.com/videos/2015/01/06/010615-whats-new-now-is-gogo-snooping-on-your-data',\n        'md5': '212d6154fd0361a2781075f1febbe9ad',\n        'info_dict': {\n            'id': 'ee10d774b508c9b8ec07e763b9125b91',\n            'ext': 'mp4',\n            'title': '010615_What\\'s New Now: Is GoGo Snooping on Your Data?',\n            'description': 'md5:a7071ae64d2f68cc821c729d4ded6bb3',\n            'timestamp': 1420571160,\n            'upload_date': '20150106',\n            'uploader_id': 'cozzipix@gmail.com',\n        }\n    }, {\n        'url': 'http://www.pcmag.com/article2/0,2817,2470156,00.asp',\n        'md5': '94130c1ca07ba0adb6088350681f16c1',\n        'info_dict': {\n            'id': '042e560ba94823d43afcb12ddf7142ca',\n            'ext': 'mp4',\n            'title': 'HTC\\'s Weird New Re Camera - What\\'s New Now',\n            'description': 'md5:53433c45df96d2ea5d0fda18be2ca908',\n            'timestamp': 1412953920,\n            'upload_date': '20141010',\n            'uploader_id': 'chris_snyder@pcmag.com',\n        }\n    }]\n", "comments": "\n    Extractor for some of the IGN sites, like www.ign.com, es.ign.com de.ign.com.\n    Some videos of it.ign.com are also supported\n    \n \n# videoId pattern\n", "content": "from __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    int_or_none,\n    parse_iso8601,\n)\n\n\nclass IGNIE(InfoExtractor):\n    \"\"\"\n    Extractor for some of the IGN sites, like www.ign.com, es.ign.com de.ign.com.\n    Some videos of it.ign.com are also supported\n    \"\"\"\n\n    _VALID_URL = r'https?://.+?\\.ign\\.com/(?:[^/]+/)?(?P<type>videos|show_videos|articles|feature|(?:[^/]+/\\d+/video))(/.+)?/(?P<name_or_id>.+)'\n    IE_NAME = 'ign.com'\n\n    _API_URL_TEMPLATE = 'http://apis.ign.com/video/v3/videos/%s'\n    _EMBED_RE = r'<iframe[^>]+?[\"\\']((?:https?:)?//.+?\\.ign\\.com.+?/embed.+?)[\"\\']'\n\n    _TESTS = [\n        {\n            'url': 'http://www.ign.com/videos/2013/06/05/the-last-of-us-review',\n            'md5': 'febda82c4bafecd2d44b6e1a18a595f8',\n            'info_dict': {\n                'id': '8f862beef863986b2785559b9e1aa599',\n                'ext': 'mp4',\n                'title': 'The Last of Us Review',\n                'description': 'md5:c8946d4260a4d43a00d5ae8ed998870c',\n                'timestamp': 1370440800,\n                'upload_date': '20130605',\n                'uploader_id': 'cberidon@ign.com',\n            }\n        },\n        {\n            'url': 'http://me.ign.com/en/feature/15775/100-little-things-in-gta-5-that-will-blow-your-mind',\n            'info_dict': {\n                'id': '100-little-things-in-gta-5-that-will-blow-your-mind',\n            },\n            'playlist': [\n                {\n                    'info_dict': {\n                        'id': '5ebbd138523268b93c9141af17bec937',\n                        'ext': 'mp4',\n                        'title': 'GTA 5 Video Review',\n                        'description': 'Rockstar drops the mic on this generation of games. Watch our review of the masterly Grand Theft Auto V.',\n                        'timestamp': 1379339880,\n                        'upload_date': '20130916',\n                        'uploader_id': 'danieljkrupa@gmail.com',\n                    },\n                },\n                {\n                    'info_dict': {\n                        'id': '638672ee848ae4ff108df2a296418ee2',\n                        'ext': 'mp4',\n                        'title': '26 Twisted Moments from GTA 5 in Slow Motion',\n                        'description': 'The twisted beauty of GTA 5 in stunning slow motion.',\n                        'timestamp': 1386878820,\n                        'upload_date': '20131212',\n                        'uploader_id': 'togilvie@ign.com',\n                    },\n                },\n            ],\n            'params': {\n                'skip_download': True,\n            },\n        },\n        {\n            'url': 'http://www.ign.com/articles/2014/08/15/rewind-theater-wild-trailer-gamescom-2014?watch',\n            'md5': '618fedb9c901fd086f6f093564ef8558',\n            'info_dict': {\n                'id': '078fdd005f6d3c02f63d795faa1b984f',\n                'ext': 'mp4',\n                'title': 'Rewind Theater - Wild Trailer Gamescom 2014',\n                'description': 'Brian and Jared explore Michel Ancel\\'s captivating new preview.',\n                'timestamp': 1408047180,\n                'upload_date': '20140814',\n                'uploader_id': 'jamesduggan1990@gmail.com',\n            },\n        },\n        {\n            'url': 'http://me.ign.com/en/videos/112203/video/how-hitman-aims-to-be-different-than-every-other-s',\n            'only_matching': True,\n        },\n        {\n            'url': 'http://me.ign.com/ar/angry-birds-2/106533/video/lrd-ldyy-lwl-lfylm-angry-birds',\n            'only_matching': True,\n        },\n        {\n            # videoId pattern\n            'url': 'http://www.ign.com/articles/2017/06/08/new-ducktales-short-donalds-birthday-doesnt-go-as-planned',\n            'only_matching': True,\n        },\n    ]\n\n    def _find_video_id(self, webpage):\n        res_id = [\n            r'\"video_id\"\\s*:\\s*\"(.*?)\"',\n            r'class=\"hero-poster[^\"]*?\"[^>]*id=\"(.+?)\"',\n            r'data-video-id=\"(.+?)\"',\n            r'<object id=\"vid_(.+?)\"',\n            r'<meta name=\"og:image\" content=\".*/(.+?)-(.+?)/.+.jpg\"',\n            r'videoId&quot;\\s*:\\s*&quot;(.+?)&quot;',\n            r'videoId[\"\\']\\s*:\\s*[\"\\']([^\"\\']+?)[\"\\']',\n        ]\n        return self._search_regex(res_id, webpage, 'video id', default=None)\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        name_or_id = mobj.group('name_or_id')\n        page_type = mobj.group('type')\n        webpage = self._download_webpage(url, name_or_id)\n        if page_type != 'video':\n            multiple_urls = re.findall(\n                r'<param name=\"flashvars\"[^>]*value=\"[^\"]*?url=(https?://www\\.ign\\.com/videos/.*?)[\"&]',\n                webpage)\n            if multiple_urls:\n                entries = [self.url_result(u, ie='IGN') for u in multiple_urls]\n                return {\n                    '_type': 'playlist',\n                    'id': name_or_id,\n                    'entries': entries,\n                }\n\n        video_id = self._find_video_id(webpage)\n        if not video_id:\n            return self.url_result(self._search_regex(\n                self._EMBED_RE, webpage, 'embed url'))\n        return self._get_video_info(video_id)\n\n    def _get_video_info(self, video_id):\n        api_data = self._download_json(\n            self._API_URL_TEMPLATE % video_id, video_id)\n\n        formats = []\n        m3u8_url = api_data['refs'].get('m3uUrl')\n        if m3u8_url:\n            formats.extend(self._extract_m3u8_formats(\n                m3u8_url, video_id, 'mp4', 'm3u8_native',\n                m3u8_id='hls', fatal=False))\n        f4m_url = api_data['refs'].get('f4mUrl')\n        if f4m_url:\n            formats.extend(self._extract_f4m_formats(\n                f4m_url, video_id, f4m_id='hds', fatal=False))\n        for asset in api_data['assets']:\n            formats.append({\n                'url': asset['url'],\n                'tbr': asset.get('actual_bitrate_kbps'),\n                'fps': asset.get('frame_rate'),\n                'height': int_or_none(asset.get('height')),\n                'width': int_or_none(asset.get('width')),\n            })\n        self._sort_formats(formats)\n\n        thumbnails = [{\n            'url': thumbnail['url']\n        } for thumbnail in api_data.get('thumbnails', [])]\n\n        metadata = api_data['metadata']\n\n        return {\n            'id': api_data.get('videoId') or video_id,\n            'title': metadata.get('longTitle') or metadata.get('name') or metadata.get['title'],\n            'description': metadata.get('description'),\n            'timestamp': parse_iso8601(metadata.get('publishDate')),\n            'duration': int_or_none(metadata.get('duration')),\n            'display_id': metadata.get('slug') or video_id,\n            'uploader_id': metadata.get('creator'),\n            'thumbnails': thumbnails,\n            'formats': formats,\n        }\n\n\nclass OneUPIE(IGNIE):\n    _VALID_URL = r'https?://gamevideos\\.1up\\.com/(?P<type>video)/id/(?P<name_or_id>.+)\\.html'\n    IE_NAME = '1up.com'\n\n    _TESTS = [{\n        'url': 'http://gamevideos.1up.com/video/id/34976.html',\n        'md5': 'c9cc69e07acb675c31a16719f909e347',\n        'info_dict': {\n            'id': '34976',\n            'ext': 'mp4',\n            'title': 'Sniper Elite V2 - Trailer',\n            'description': 'md5:bf0516c5ee32a3217aa703e9b1bc7826',\n            'timestamp': 1313099220,\n            'upload_date': '20110811',\n            'uploader_id': 'IGN',\n        }\n    }]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        result = super(OneUPIE, self)._real_extract(url)\n        result['id'] = mobj.group('name_or_id')\n        return result\n\n\nclass PCMagIE(IGNIE):\n    _VALID_URL = r'https?://(?:www\\.)?pcmag\\.com/(?P<type>videos|article2)(/.+)?/(?P<name_or_id>.+)'\n    IE_NAME = 'pcmag'\n\n    _EMBED_RE = r'iframe\\.setAttribute\\(\"src\",\\s*__util.objToUrlString\\(\"http://widgets\\.ign\\.com/video/embed/content\\.html?[^\"]*url=([^\"]+)[\"&]'\n\n    _TESTS = [{\n        'url': 'http://www.pcmag.com/videos/2015/01/06/010615-whats-new-now-is-gogo-snooping-on-your-data',\n        'md5': '212d6154fd0361a2781075f1febbe9ad',\n        'info_dict': {\n            'id': 'ee10d774b508c9b8ec07e763b9125b91',\n            'ext': 'mp4',\n            'title': '010615_What\\'s New Now: Is GoGo Snooping on Your Data?',\n            'description': 'md5:a7071ae64d2f68cc821c729d4ded6bb3',\n            'timestamp': 1420571160,\n            'upload_date': '20150106',\n            'uploader_id': 'cozzipix@gmail.com',\n        }\n    }, {\n        'url': 'http://www.pcmag.com/article2/0,2817,2470156,00.asp',\n        'md5': '94130c1ca07ba0adb6088350681f16c1',\n        'info_dict': {\n            'id': '042e560ba94823d43afcb12ddf7142ca',\n            'ext': 'mp4',\n            'title': 'HTC\\'s Weird New Re Camera - What\\'s New Now',\n            'description': 'md5:53433c45df96d2ea5d0fda18be2ca908',\n            'timestamp': 1412953920,\n            'upload_date': '20141010',\n            'uploader_id': 'chris_snyder@pcmag.com',\n        }\n    }]\n", "description": "Command-line program to download videos from YouTube.com and other video sites", "file_name": "ign.py", "language": "Python", "project_name": "youtube-dl", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/rg3_youtube-dl/rg3-youtube-dl-6202f08/youtube_dl/extractor/ign.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:18:39Z", "url": "https://github.com/rg3/youtube-dl", "wiki": false}