{"author": "rg3", "code": "from __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    fix_xml_ampersands,\n)\n\n\nclass MetacriticIE(InfoExtractor):\n    _VALID_URL = r'https?://(?:www\\.)?metacritic\\.com/.+?/trailers/(?P<id>\\d+)'\n\n    _TESTS = [{\n        'url': 'http://www.metacritic.com/game/playstation-4/infamous-second-son/trailers/3698222',\n        'info_dict': {\n            'id': '3698222',\n            'ext': 'mp4',\n            'title': 'inFamous: Second Son - inSide Sucker Punch: Smoke & Mirrors',\n            'description': 'Take a peak behind-the-scenes to see how Sucker Punch brings smoke into the universe of inFAMOUS Second Son on the PS4.',\n            'duration': 221,\n        },\n        'skip': 'Not providing trailers anymore',\n    }, {\n        'url': 'http://www.metacritic.com/game/playstation-4/tales-from-the-borderlands-a-telltale-game-series/trailers/5740315',\n        'info_dict': {\n            'id': '5740315',\n            'ext': 'mp4',\n            'title': 'Tales from the Borderlands - Finale: The Vault of the Traveler',\n            'description': 'In the final episode of the season, all hell breaks loose. Jack is now in control of Helios\\' systems, and he\\'s ready to reclaim his rightful place as king of Hyperion (with or without you).',\n            'duration': 114,\n        },\n    }]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        video_id = mobj.group('id')\n        webpage = self._download_webpage(url, video_id)\n        \n        info = self._download_xml('http://www.metacritic.com/video_data?video=' + video_id,\n                                  video_id, 'Downloading info xml', transform_source=fix_xml_ampersands)\n\n        clip = next(c for c in info.findall('playList/clip') if c.find('id').text == video_id)\n        formats = []\n        for videoFile in clip.findall('httpURI/videoFile'):\n            rate_str = videoFile.find('rate').text\n            video_url = videoFile.find('filePath').text\n            formats.append({\n                'url': video_url,\n                'ext': 'mp4',\n                'format_id': rate_str,\n                'tbr': int(rate_str),\n            })\n        self._sort_formats(formats)\n\n        description = self._html_search_regex(r'<b>Description:</b>(.*?)</p>',\n                                              webpage, 'description', flags=re.DOTALL)\n\n        return {\n            'id': video_id,\n            'title': clip.find('title').text,\n            'formats': formats,\n            'description': description,\n            'duration': int(clip.find('duration').text),\n        }\n", "comments": "# The xml is not well formatted, there are raw '&'\n", "content": "from __future__ import unicode_literals\n\nimport re\n\nfrom .common import InfoExtractor\nfrom ..utils import (\n    fix_xml_ampersands,\n)\n\n\nclass MetacriticIE(InfoExtractor):\n    _VALID_URL = r'https?://(?:www\\.)?metacritic\\.com/.+?/trailers/(?P<id>\\d+)'\n\n    _TESTS = [{\n        'url': 'http://www.metacritic.com/game/playstation-4/infamous-second-son/trailers/3698222',\n        'info_dict': {\n            'id': '3698222',\n            'ext': 'mp4',\n            'title': 'inFamous: Second Son - inSide Sucker Punch: Smoke & Mirrors',\n            'description': 'Take a peak behind-the-scenes to see how Sucker Punch brings smoke into the universe of inFAMOUS Second Son on the PS4.',\n            'duration': 221,\n        },\n        'skip': 'Not providing trailers anymore',\n    }, {\n        'url': 'http://www.metacritic.com/game/playstation-4/tales-from-the-borderlands-a-telltale-game-series/trailers/5740315',\n        'info_dict': {\n            'id': '5740315',\n            'ext': 'mp4',\n            'title': 'Tales from the Borderlands - Finale: The Vault of the Traveler',\n            'description': 'In the final episode of the season, all hell breaks loose. Jack is now in control of Helios\\' systems, and he\\'s ready to reclaim his rightful place as king of Hyperion (with or without you).',\n            'duration': 114,\n        },\n    }]\n\n    def _real_extract(self, url):\n        mobj = re.match(self._VALID_URL, url)\n        video_id = mobj.group('id')\n        webpage = self._download_webpage(url, video_id)\n        # The xml is not well formatted, there are raw '&'\n        info = self._download_xml('http://www.metacritic.com/video_data?video=' + video_id,\n                                  video_id, 'Downloading info xml', transform_source=fix_xml_ampersands)\n\n        clip = next(c for c in info.findall('playList/clip') if c.find('id').text == video_id)\n        formats = []\n        for videoFile in clip.findall('httpURI/videoFile'):\n            rate_str = videoFile.find('rate').text\n            video_url = videoFile.find('filePath').text\n            formats.append({\n                'url': video_url,\n                'ext': 'mp4',\n                'format_id': rate_str,\n                'tbr': int(rate_str),\n            })\n        self._sort_formats(formats)\n\n        description = self._html_search_regex(r'<b>Description:</b>(.*?)</p>',\n                                              webpage, 'description', flags=re.DOTALL)\n\n        return {\n            'id': video_id,\n            'title': clip.find('title').text,\n            'formats': formats,\n            'description': description,\n            'duration': int(clip.find('duration').text),\n        }\n", "description": "Command-line program to download videos from YouTube.com and other video sites", "file_name": "metacritic.py", "language": "Python", "project_name": "youtube-dl", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/rg3_youtube-dl/rg3-youtube-dl-6202f08/youtube_dl/extractor/metacritic.py", "save_time": "", "source": "", "update_at": "2018-03-07T09:18:39Z", "url": "https://github.com/rg3/youtube-dl", "wiki": false}