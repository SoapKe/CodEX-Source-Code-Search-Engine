{"author": "odoo", "code": "# -*- coding: utf-8 -*-\n\n\nfrom odoo import http\nfrom odoo.http import request\n\nGENGO_DEFAULT_LIMIT = 20\n\n\nclass WebsiteGengo(http.Controller):\n\n    @http.route('/website/get_translated_length', type='json', auth='user', website=True)\n    def get_translated_length(self, translated_ids, lang):\n        result = {\"done\": 0}\n        gengo_translation_ids = request.env['ir.translation'].search([('id', 'in', translated_ids), ('gengo_translation', '!=', False)])\n        for trans in gengo_translation_ids:\n            result['done'] += len(trans.source.split())\n        return result\n\n    @http.route('/website/check_gengo_set', type='json', auth='user', website=True)\n    def check_gengo_set(self):\n        company = request.env.user.sudo().company_id\n        company_flag = 0\n        if not company.gengo_public_key or not company.gengo_private_key:\n            company_flag = company.id\n        return company_flag\n\n    @http.route('/website/set_gengo_config', type='json', auth='user', website=True)\n    def set_gengo_config(self, config):\n        request.env.user.company_id.write(config)\n        return True\n\n    @http.route('/website/post_gengo_jobs', type='json', auth='user', website=True)\n    def post_gengo_jobs(self):\n        request.env['base.gengo.translations']._sync_request(limit=GENGO_DEFAULT_LIMIT)\n        return True\n\n    @http.route('/website_gengo/set_translations', type='json', auth='user', website=True)\n    def set_translations(self, data, lang):\n        IrTranslation = request.env['ir.translation']\n        for term in data:\n            initial_content = term['initial_content'].strip()\n            translation_ids = term['translation_id']\n            if not translation_ids:\n                translations = IrTranslation.search_read([('lang', '=', lang), ('src', '=', initial_content)], fields=['id'])\n                if translations:\n                    translation_ids = [t_id['id'] for t_id in translations]\n\n            vals = {\n                'gengo_comment': term['gengo_comment'],\n                'gengo_translation': term['gengo_translation'],\n                'state': 'to_translate',\n            }\n            if translation_ids:\n                IrTranslation.browse(translation_ids).write(vals)\n            else:\n                vals.update({\n                    'name': 'website',\n                    'lang': lang,\n                    'source': initial_content,\n                })\n                IrTranslation.create(vals)\n        return True\n", "comments": "      coding  utf 8        part odoo  see license file full copyright licensing details  ", "content": "# -*- coding: utf-8 -*-\n# Part of Odoo. See LICENSE file for full copyright and licensing details.\n\nfrom odoo import http\nfrom odoo.http import request\n\nGENGO_DEFAULT_LIMIT = 20\n\n\nclass WebsiteGengo(http.Controller):\n\n    @http.route('/website/get_translated_length', type='json', auth='user', website=True)\n    def get_translated_length(self, translated_ids, lang):\n        result = {\"done\": 0}\n        gengo_translation_ids = request.env['ir.translation'].search([('id', 'in', translated_ids), ('gengo_translation', '!=', False)])\n        for trans in gengo_translation_ids:\n            result['done'] += len(trans.source.split())\n        return result\n\n    @http.route('/website/check_gengo_set', type='json', auth='user', website=True)\n    def check_gengo_set(self):\n        company = request.env.user.sudo().company_id\n        company_flag = 0\n        if not company.gengo_public_key or not company.gengo_private_key:\n            company_flag = company.id\n        return company_flag\n\n    @http.route('/website/set_gengo_config', type='json', auth='user', website=True)\n    def set_gengo_config(self, config):\n        request.env.user.company_id.write(config)\n        return True\n\n    @http.route('/website/post_gengo_jobs', type='json', auth='user', website=True)\n    def post_gengo_jobs(self):\n        request.env['base.gengo.translations']._sync_request(limit=GENGO_DEFAULT_LIMIT)\n        return True\n\n    @http.route('/website_gengo/set_translations', type='json', auth='user', website=True)\n    def set_translations(self, data, lang):\n        IrTranslation = request.env['ir.translation']\n        for term in data:\n            initial_content = term['initial_content'].strip()\n            translation_ids = term['translation_id']\n            if not translation_ids:\n                translations = IrTranslation.search_read([('lang', '=', lang), ('src', '=', initial_content)], fields=['id'])\n                if translations:\n                    translation_ids = [t_id['id'] for t_id in translations]\n\n            vals = {\n                'gengo_comment': term['gengo_comment'],\n                'gengo_translation': term['gengo_translation'],\n                'state': 'to_translate',\n            }\n            if translation_ids:\n                IrTranslation.browse(translation_ids).write(vals)\n            else:\n                vals.update({\n                    'name': 'website',\n                    'lang': lang,\n                    'source': initial_content,\n                })\n                IrTranslation.create(vals)\n        return True\n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "main.py", "id": "4231ea6dbc9a8593235d6aa1a3489647", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/website_gengo/controllers/main.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}