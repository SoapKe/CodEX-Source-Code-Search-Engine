{"author": "getredash", "code": "\nfrom alembic import op\nimport sqlalchemy as sa\nimport sqlalchemy_searchable as ss\n\n\n\nrevision = '6b5be7e0a0ef'\ndown_revision = '5ec5c84ba61e'\nbranch_labels = None\ndepends_on = None\n\n\ndef upgrade():\n    ss.vectorizer.clear()\n\n    conn = op.get_bind()\n\n    metadata = sa.MetaData(bind=conn)\n    queries = sa.Table('queries', metadata, autoload=True)\n\n    @ss.vectorizer(queries.c.id)\n    def integer_vectorizer(column):\n        return sa.func.cast(column, sa.Text)\n\n    ss.sync_trigger(\n        conn,\n        'queries',\n        'search_vector',\n        ['id', 'name', 'description', 'query'],\n        metadata=metadata\n    )\n\n\ndef downgrade():\n    conn = op.get_bind()\n    ss.drop_trigger(conn, 'queries', 'search_vector')\n    op.drop_index('ix_queries_search_vector', table_name='queries')\n    op.create_index('ix_queries_search_vector', 'queries', ['search_vector'],\n                    unique=False, postgresql_using='gin')\n    ss.sync_trigger(conn, 'queries', 'search_vector',\n                    ['name', 'description', 'query'])\n", "comments": "   re index query search vector existing queries   revision id  6b5be7e0a0ef revises  5ec5c84ba61e create date  2017 11 02 20 42 13 356360         revision identifiers  used alembic  ", "content": "\"\"\"Re-index Query.search_vector with existing queries.\n\nRevision ID: 6b5be7e0a0ef\nRevises: 5ec5c84ba61e\nCreate Date: 2017-11-02 20:42:13.356360\n\n\"\"\"\nfrom alembic import op\nimport sqlalchemy as sa\nimport sqlalchemy_searchable as ss\n\n\n# revision identifiers, used by Alembic.\nrevision = '6b5be7e0a0ef'\ndown_revision = '5ec5c84ba61e'\nbranch_labels = None\ndepends_on = None\n\n\ndef upgrade():\n    ss.vectorizer.clear()\n\n    conn = op.get_bind()\n\n    metadata = sa.MetaData(bind=conn)\n    queries = sa.Table('queries', metadata, autoload=True)\n\n    @ss.vectorizer(queries.c.id)\n    def integer_vectorizer(column):\n        return sa.func.cast(column, sa.Text)\n\n    ss.sync_trigger(\n        conn,\n        'queries',\n        'search_vector',\n        ['id', 'name', 'description', 'query'],\n        metadata=metadata\n    )\n\n\ndef downgrade():\n    conn = op.get_bind()\n    ss.drop_trigger(conn, 'queries', 'search_vector')\n    op.drop_index('ix_queries_search_vector', table_name='queries')\n    op.create_index('ix_queries_search_vector', 'queries', ['search_vector'],\n                    unique=False, postgresql_using='gin')\n    ss.sync_trigger(conn, 'queries', 'search_vector',\n                    ['name', 'description', 'query'])\n", "description": "Make Your Company Data Driven. Connect to any data source, easily visualize and share your data.", "file_name": "6b5be7e0a0ef_.py", "id": "556702b994da8084e7509c5942f5256a", "language": "Python", "project_name": "redash", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/getredash-redash/getredash-redash-0410d83/migrations/versions/6b5be7e0a0ef_.py", "save_time": "", "source": "", "update_at": "2018-03-18T12:54:55Z", "url": "https://github.com/getredash/redash", "wiki": false}