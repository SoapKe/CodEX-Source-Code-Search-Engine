{"author": "getsentry", "code": "# -*- coding: utf-8 -*-\n\nfrom __future__ import absolute_import\n\nfrom django.test.client import RequestFactory\n\nfrom sentry.testutils import TestCase\nfrom sentry.utils import linksign\n\n\nclass LinkSignTestCase(TestCase):\n    def test_link_signing(self):\n        rf = RequestFactory()\n\n        url = linksign.generate_signed_link(self.user, 'sentry')\n        assert url.startswith('http://')\n\n        req = rf.get('/' + url.split('/', 3)[-1])\n        signed_user = linksign.process_signature(req)\n        assert signed_user\n        assert signed_user.id == self.user.id\n\n        req = rf.get('/what' + url.split('/', 3)[-1])\n        signed_user = linksign.process_signature(req)\n        assert signed_user is None\n\n        req = rf.get('/' + url.split('/', 3)[-1] + 'garbage')\n        signed_user = linksign.process_signature(req)\n        assert signed_user is None\n\n        rf.defaults['SERVER_NAME'] = 'something-else'\n        req = rf.get('/' + url.split('/', 3)[-1])\n        signed_user = linksign.process_signature(req)\n        assert signed_user is None\n", "comments": "      coding  utf 8     ", "content": "# -*- coding: utf-8 -*-\n\nfrom __future__ import absolute_import\n\nfrom django.test.client import RequestFactory\n\nfrom sentry.testutils import TestCase\nfrom sentry.utils import linksign\n\n\nclass LinkSignTestCase(TestCase):\n    def test_link_signing(self):\n        rf = RequestFactory()\n\n        url = linksign.generate_signed_link(self.user, 'sentry')\n        assert url.startswith('http://')\n\n        req = rf.get('/' + url.split('/', 3)[-1])\n        signed_user = linksign.process_signature(req)\n        assert signed_user\n        assert signed_user.id == self.user.id\n\n        req = rf.get('/what' + url.split('/', 3)[-1])\n        signed_user = linksign.process_signature(req)\n        assert signed_user is None\n\n        req = rf.get('/' + url.split('/', 3)[-1] + 'garbage')\n        signed_user = linksign.process_signature(req)\n        assert signed_user is None\n\n        rf.defaults['SERVER_NAME'] = 'something-else'\n        req = rf.get('/' + url.split('/', 3)[-1])\n        signed_user = linksign.process_signature(req)\n        assert signed_user is None\n", "description": "Sentry is a cross-platform crash reporting and aggregation platform.", "file_name": "test_linksign.py", "id": "86b438ea3e3428a76132d6076a46cf62", "language": "Python", "project_name": "sentry", "quality": "", "save_path": "/home/ubuntu/test_files/clean/network_test/getsentry-sentry/getsentry-sentry-6a9c7e2/tests/sentry/utils/test_linksign.py", "save_time": "", "source": "", "update_at": "2018-03-14T01:23:24Z", "url": "https://github.com/getsentry/sentry", "wiki": false}