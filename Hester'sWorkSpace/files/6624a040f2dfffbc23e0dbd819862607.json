{"author": "odoo", "code": " -*- coding: utf-8 -*-\n\n\nfrom odoo import api, models\n\n\n\n\n\n\n\n\n\n\n\n\n This is hotfixed by overriding the unlink method so as to not delete\n the website_description field if website_quote is uninstalled, it's\n an ugly hack but it works and big changes can't be done to the ORM\n in stable versions, Odoo v12+ will properly fix this\n\n\nclass IrModelFields(models.Model):\n    _inherit = \"ir.model.fields\"\n\n    @api.multi\n    def unlink(self):\n         Prevent the deletion of the field \"website_description\"\n        self = self.filtered(\n            lambda rec: not (\n                rec.model in ('product.product', 'product.template') and\n                rec.name == 'website_description'\n            )\n        )\n        return super(IrModelFields, self).unlink()\n", "comments": "      coding  utf 8        part odoo  see license file full copyright licensing details        attention  hack hack  try home       this done website quote defines website description    field also defined website sale  two modules    independent  part orm generates    xmlids support case therefore creates single    pair xmlids whichever module installed first  therefore    uninstalling two modules website descripion field    deleted db module able    use field  resulting crash data loss     see opw 776464 details        this hotfixed overriding unlink method delete    website description field website quote uninstalled     ugly hack works big changes done orm    stable versions  odoo v12  properly fix    prevent deletion field  website description  ", "content": "# -*- coding: utf-8 -*-\n# Part of Odoo. See LICENSE file for full copyright and licensing details.\n\nfrom odoo import api, models\n\n# !! Attention, this is a hack of a hack, do not try this at home !!\n# This is done because website_quote defines the website_description\n# field which is also defined by website_sale, but these two modules\n# are independent of each other, the part of the ORM that generates\n# xmlids does not support this case therefore it only creates a single\n# pair of xmlids for whichever module is installed first, therefore\n# when uninstalling any of the two modules the website_descripion field\n# will be deleted from the db and the other module won't be able to\n# use this field, resulting in a crash and data-loss.\n# See opw-776464 for more details.\n#\n# This is hotfixed by overriding the unlink method so as to not delete\n# the website_description field if website_quote is uninstalled, it's\n# an ugly hack but it works and big changes can't be done to the ORM\n# in stable versions, Odoo v12+ will properly fix this\n\n\nclass IrModelFields(models.Model):\n    _inherit = \"ir.model.fields\"\n\n    @api.multi\n    def unlink(self):\n        # Prevent the deletion of the field \"website_description\"\n        self = self.filtered(\n            lambda rec: not (\n                rec.model in ('product.product', 'product.template') and\n                rec.name == 'website_description'\n            )\n        )\n        return super(IrModelFields, self).unlink()\n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "ir_model_fields.py", "id": "6624a040f2dfffbc23e0dbd819862607", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/website_quote/models/ir_model_fields.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}