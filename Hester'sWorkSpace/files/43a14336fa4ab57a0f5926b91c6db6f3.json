{"author": "odoo", "code": "# -*- coding: utf-8 -*-\n\n\nfrom odoo import http\nfrom odoo.http import request\nfrom odoo.addons.website_form.controllers.main import WebsiteForm\n\nclass WebsiteForm(WebsiteForm):\n\n    \n    @http.route('/website_form/<string:model_name>', type='http', auth=\"public\", methods=['POST'], website=True)\n    def website_form(self, model_name, **kwargs):\n        if model_name == 'crm.lead' and not request.params.get('state_id'):\n            geoip_country_code = request.session.get('geoip', {}).get('country_code')\n            geoip_state_code = request.session.get('geoip', {}).get('region')\n            if geoip_country_code and geoip_state_code:\n                State = request.env['res.country.state']\n                request.params['state_id'] = State.search([('code', '=', geoip_state_code), ('country_id.code', '=', geoip_country_code)]).id\n\n        return super(WebsiteForm, self).website_form(model_name, **kwargs)\n", "comments": "      coding  utf 8        part odoo  see license file full copyright licensing details     check insert values form model  model  ", "content": "# -*- coding: utf-8 -*-\n# Part of Odoo. See LICENSE file for full copyright and licensing details.\n\nfrom odoo import http\nfrom odoo.http import request\nfrom odoo.addons.website_form.controllers.main import WebsiteForm\n\nclass WebsiteForm(WebsiteForm):\n\n    # Check and insert values from the form on the model <model>\n    @http.route('/website_form/<string:model_name>', type='http', auth=\"public\", methods=['POST'], website=True)\n    def website_form(self, model_name, **kwargs):\n        if model_name == 'crm.lead' and not request.params.get('state_id'):\n            geoip_country_code = request.session.get('geoip', {}).get('country_code')\n            geoip_state_code = request.session.get('geoip', {}).get('region')\n            if geoip_country_code and geoip_state_code:\n                State = request.env['res.country.state']\n                request.params['state_id'] = State.search([('code', '=', geoip_state_code), ('country_id.code', '=', geoip_country_code)]).id\n\n        return super(WebsiteForm, self).website_form(model_name, **kwargs)\n", "description": "Odoo. Open Source Apps To Grow Your Business.", "file_name": "main.py", "id": "43a14336fa4ab57a0f5926b91c6db6f3", "language": "Python", "project_name": "odoo", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/odoo-odoo/odoo-odoo-b25250f/addons/website_crm/controllers/main.py", "save_time": "", "source": "", "update_at": "2018-03-18T08:30:22Z", "url": "https://github.com/odoo/odoo", "wiki": true}