{"author": "tgalal", "code": "from yowsup.layers import YowLayer\nfrom yowsup import ProtocolTreeNode\nfrom .mediadownloader import MediaDownloader\nimport shutil, os, logging\nlogger = logging.getLogger(__name__)\n\nclass YowMediaPictureLayer(YowLayer):\n    def send(self, data):\n        self.toLower(data)\n\n    def receive(self, node):\n        if ProtocolTreeNode.tagEquals(node, \"message\") and node.getAttributeValue(\"type\") == \"media\":\n            self.downloadMedia(node.getChild(\"media\").getAttributeValue(\"url\"))\n        else:\n            self.toUpper(node)\n\n    def downloadMedia(self, url):\n        logger.debug(\"Downloading %s\" % url)\n        downloader = MediaDownloader(self.onSuccess, self.onError, self.onProgress)\n        downloader.download(url)\n\n    def onError(self):\n        logger.error(\"Error download file\")\n\n    def onSuccess(self, path):\n        outPath = \"/tmp/yowfiles/%s.jpg\" % os.path.basename(path)\n        shutil.copyfile(path, outPath)\n        logger.debug(\"Picture downloaded to %s\" % outPath)\n\n    def onProgress(self, progress):\n        logger.debug(\"Download progress %s\" % progress)\n", "comments": "", "content": "from yowsup.layers import YowLayer\nfrom yowsup import ProtocolTreeNode\nfrom .mediadownloader import MediaDownloader\nimport shutil, os, logging\nlogger = logging.getLogger(__name__)\n\nclass YowMediaPictureLayer(YowLayer):\n    def send(self, data):\n        self.toLower(data)\n\n    def receive(self, node):\n        if ProtocolTreeNode.tagEquals(node, \"message\") and node.getAttributeValue(\"type\") == \"media\":\n            self.downloadMedia(node.getChild(\"media\").getAttributeValue(\"url\"))\n        else:\n            self.toUpper(node)\n\n    def downloadMedia(self, url):\n        logger.debug(\"Downloading %s\" % url)\n        downloader = MediaDownloader(self.onSuccess, self.onError, self.onProgress)\n        downloader.download(url)\n\n    def onError(self):\n        logger.error(\"Error download file\")\n\n    def onSuccess(self, path):\n        outPath = \"/tmp/yowfiles/%s.jpg\" % os.path.basename(path)\n        shutil.copyfile(path, outPath)\n        logger.debug(\"Picture downloaded to %s\" % outPath)\n\n    def onProgress(self, progress):\n        logger.debug(\"Download progress %s\" % progress)\n", "description": "The python WhatsApp library", "file_name": "picture.py", "id": "48c05893a102e8a25be015df1461b658", "language": "Python", "project_name": "yowsup", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/tgalal-yowsup/tgalal-yowsup-03795cc/yowsup/layers/protocol_media/picture.py", "save_time": "", "source": "", "update_at": "2018-03-18T13:01:40Z", "url": "https://github.com/tgalal/yowsup", "wiki": true}