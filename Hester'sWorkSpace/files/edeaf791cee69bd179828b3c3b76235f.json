{"author": "tgalal", "code": "from yowsup.layers import YowLayer, YowLayerEvent, YowProtocolLayer\nfrom .protocolentities import *\nfrom yowsup.layers.protocol_iq.protocolentities import ErrorIqProtocolEntity\nclass YowPresenceProtocolLayer(YowProtocolLayer):\n    def __init__(self):\n        handleMap = {\n            \"presence\": (self.recvPresence, self.sendPresence),\n            \"iq\":       (None, self.sendIq)\n        }\n        super(YowPresenceProtocolLayer, self).__init__(handleMap)\n\n    def __str__(self):\n        return \"Presence Layer\"\n\n    def sendPresence(self, entity):\n        self.entityToLower(entity)\n\n    def recvPresence(self, node):\n        self.toUpper(PresenceProtocolEntity.fromProtocolTreeNode(node))\n\n    def sendIq(self, entity):\n        if entity.getXmlns() == LastseenIqProtocolEntity.XMLNS:\n            self._sendIq(entity, self.onLastSeenSuccess, self.onLastSeenError)\n\n    def onLastSeenSuccess(self, protocolTreeNode, lastSeenEntity):\n        self.toUpper(ResultLastseenIqProtocolEntity.fromProtocolTreeNode(protocolTreeNode))\n\n    def onLastSeenError(self, protocolTreeNode, lastSeenEntity):\n        self.toUpper(ErrorIqProtocolEntity.fromProtocolTreeNode(protocolTreeNode))\n", "comments": "", "content": "from yowsup.layers import YowLayer, YowLayerEvent, YowProtocolLayer\nfrom .protocolentities import *\nfrom yowsup.layers.protocol_iq.protocolentities import ErrorIqProtocolEntity\nclass YowPresenceProtocolLayer(YowProtocolLayer):\n    def __init__(self):\n        handleMap = {\n            \"presence\": (self.recvPresence, self.sendPresence),\n            \"iq\":       (None, self.sendIq)\n        }\n        super(YowPresenceProtocolLayer, self).__init__(handleMap)\n\n    def __str__(self):\n        return \"Presence Layer\"\n\n    def sendPresence(self, entity):\n        self.entityToLower(entity)\n\n    def recvPresence(self, node):\n        self.toUpper(PresenceProtocolEntity.fromProtocolTreeNode(node))\n\n    def sendIq(self, entity):\n        if entity.getXmlns() == LastseenIqProtocolEntity.XMLNS:\n            self._sendIq(entity, self.onLastSeenSuccess, self.onLastSeenError)\n\n    def onLastSeenSuccess(self, protocolTreeNode, lastSeenEntity):\n        self.toUpper(ResultLastseenIqProtocolEntity.fromProtocolTreeNode(protocolTreeNode))\n\n    def onLastSeenError(self, protocolTreeNode, lastSeenEntity):\n        self.toUpper(ErrorIqProtocolEntity.fromProtocolTreeNode(protocolTreeNode))\n", "description": "The python WhatsApp library", "file_name": "layer.py", "id": "edeaf791cee69bd179828b3c3b76235f", "language": "Python", "project_name": "yowsup", "quality": "", "save_path": "/home/ubuntu/test_files/clean/python/tgalal-yowsup/tgalal-yowsup-03795cc/yowsup/layers/protocol_presence/layer.py", "save_time": "", "source": "", "update_at": "2018-03-18T13:01:40Z", "url": "https://github.com/tgalal/yowsup", "wiki": true}